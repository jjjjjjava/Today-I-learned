Dexä¼˜åŒ–ä»»åŠ¡

- 

```
package com.ovopark.plugin

import org.gradle.api.DefaultTask
import org.gradle.api.tasks.Input
import org.gradle.api.tasks.TaskAction
import java.io.File
import java.util.*

/**
 * Dexä¼˜åŒ–ä»»åŠ¡
 * ä¸»è¦åŠŸèƒ½ï¼š
 * 1. åˆ†æDexæ–‡ä»¶å¤§å°å’Œç»“æ„
 * 2. ä¼˜åŒ–MultiDexåˆ†åŒ…ç­–ç•¥
 * 3. ç”ŸæˆDexæ€§èƒ½æŠ¥å‘Š
 */
open class DexOptimizationTask : DefaultTask() {
    
    @Input
    lateinit var variantName: String
    
    @Input
    lateinit var extension: OptimizationExtension
    
    @TaskAction
    fun optimize() {
        println("ğŸš€ å¼€å§‹ä¸ºå˜ä½“ '$variantName' æ‰§è¡Œ Dex ä¼˜åŒ–...")
        
        if (extension.enableDexOptimization) {
            analyzeDexStructure()
            optimizeMultiDexConfiguration()
            generateDexReport()
        } else {
            println("âš ï¸ Dex ä¼˜åŒ–å·²ç¦ç”¨")
        }
        
        println("âœ… Dex ä¼˜åŒ–å®Œæˆ")
    }
    
    private fun analyzeDexStructure() {
        println("ğŸ“Š åˆ†æ Dex æ–‡ä»¶ç»“æ„...")
        
        // åˆ†æå½“å‰é¡¹ç›®çš„æ¨¡å—ä¾èµ–
        val dependencies = project.configurations.getByName("implementation").dependencies
        val moduleCount = dependencies.size
        
        println("ğŸ“¦ æ£€æµ‹åˆ° $moduleCount ä¸ªä¾èµ–æ¨¡å—")
        
        // å¦‚æœæ¨¡å—æ•°é‡è¾ƒå¤šï¼Œå»ºè®®ä¼˜åŒ–ç­–ç•¥
        if (moduleCount > 50) {
            println("âš ï¸ æ£€æµ‹åˆ°å¤§é‡æ¨¡å—ä¾èµ–ï¼Œå»ºè®®å¯ç”¨ä»¥ä¸‹ä¼˜åŒ–ï¼š")
            println("   1. å¯ç”¨å¢é‡ç¼–è¯‘")
            println("   2. ä½¿ç”¨æ¨¡å—åŒ–åŠ è½½")
            println("   3. å»¶è¿Ÿåˆå§‹åŒ–éå…³é”®æ¨¡å—")
        }
    }
    
    private fun optimizeMultiDexConfiguration() {
        println("ğŸ”§ ä¼˜åŒ– MultiDex é…ç½®...")
        
        // æ£€æŸ¥æ˜¯å¦éœ€è¦MultiDex
        val buildDir = project.buildDir
        val manifestFile = File(buildDir, "intermediates/merged_manifests/$variantName/AndroidManifest.xml")
        
        if (manifestFile.exists()) {
            println("âœ… æ£€æµ‹åˆ° Manifest æ–‡ä»¶ï¼ŒMultiDex é…ç½®æœ‰æ•ˆ")
        }
        
        // ç”Ÿæˆä¼˜åŒ–å»ºè®®
        val suggestions = generateOptimizationSuggestions()
        if (suggestions.isNotEmpty()) {
            println("ğŸ’¡ ä¼˜åŒ–å»ºè®®ï¼š")
            suggestions.forEach { suggestion ->
                println("   â€¢ $suggestion")
            }
        }
    }
    
    private fun generateOptimizationSuggestions(): List<String> {
        val suggestions = mutableListOf<String>()
        
        // åŸºäºé¡¹ç›®åˆ†æç”Ÿæˆå»ºè®®
        val projectFiles = project.fileTree("src/main/java").files
        val javaFileCount = projectFiles.filter { it.extension == "java" }.size
        val kotlinFileCount = projectFiles.filter { it.extension == "kt" }.size
        
        if (javaFileCount + kotlinFileCount > 1000) {
            suggestions.add("è€ƒè™‘ä½¿ç”¨ R8/ProGuard è¿›è¡Œä»£ç å‹ç¼©")
        }
        
        if (javaFileCount > kotlinFileCount * 2) {
            suggestions.add("è€ƒè™‘å°† Java ä»£ç è¿ç§»åˆ° Kotlin ä»¥å‡å°‘å­—èŠ‚ç å¤§å°")
        }
        
        // æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†å¤§å‹ç¬¬ä¸‰æ–¹åº“
        val dependencies = project.configurations.getByName("implementation").dependencies
        val heavyLibraries = dependencies.filter { dep ->
            listOf("fresco", "gson", "retrofit", "okhttp", "glide").any { 
                dep.name.contains(it, ignoreCase = true) 
            }
        }
        
        if (heavyLibraries.size > 3) {
            suggestions.add("æ£€æŸ¥æ˜¯å¦å¯ä»¥æ›¿æ¢æˆ–ç²¾ç®€ç¬¬ä¸‰æ–¹åº“ä¾èµ–")
        }
        
        return suggestions
    }
    
    private fun generateDexReport() {
        println("ğŸ“„ ç”Ÿæˆ Dex ä¼˜åŒ–æŠ¥å‘Š...")
        
        val reportFile = File(project.buildDir, "reports/dex-optimization-$variantName.txt")
        reportFile.parentFile?.mkdirs()
        
        val report = buildString {
            appendLine("=== Dex ä¼˜åŒ–æŠ¥å‘Š ===")
            appendLine("å˜ä½“: $variantName")
            appendLine("ç”Ÿæˆæ—¶é—´: ${Date()}")
            appendLine()
            
            appendLine("é…ç½®ä¿¡æ¯:")
            appendLine("- Dex ä¼˜åŒ–: ${extension.enableDexOptimization}")
            appendLine("- MultiDex ä¼˜åŒ–: ${extension.enableMultiDexOptimization}")
            appendLine("- å†…å­˜é™åˆ¶: ${extension.dexMemoryLimit}")
            appendLine("- å¹¶è¡Œå¤„ç†: ${extension.enableParallelDex}")
            appendLine()
            
            appendLine("é¡¹ç›®ç»Ÿè®¡:")
            val javaFiles = project.fileTree("src/main/java").files.filter { it.extension == "java" }
            val kotlinFiles = project.fileTree("src/main/java").files.filter { it.extension == "kt" }
            appendLine("- Java æ–‡ä»¶: ${javaFiles.size}")
            appendLine("- Kotlin æ–‡ä»¶: ${kotlinFiles.size}")
            appendLine("- æ€»ä»£ç æ–‡ä»¶: ${javaFiles.size + kotlinFiles.size}")
            appendLine()
            
            val suggestions = generateOptimizationSuggestions()
            if (suggestions.isNotEmpty()) {
                appendLine("ä¼˜åŒ–å»ºè®®:")
                suggestions.forEach { suggestion ->
                    appendLine("- $suggestion")
                }
            }
        }
        
        reportFile.writeText(report)
        println("ğŸ“‹ æŠ¥å‘Šå·²ç”Ÿæˆ: ${reportFile.absolutePath}")
    }
} 
```

ç”ŸæˆMultiDexä¿ç•™åˆ—è¡¨ä»»åŠ¡

- ```
  package com.ovopark.plugin
  
  import org.gradle.api.DefaultTask
  import org.gradle.api.tasks.Input
  import org.gradle.api.tasks.OutputFile
  import org.gradle.api.tasks.TaskAction
  import java.io.File
  
  /**
   * ç”ŸæˆMultiDexä¿ç•™åˆ—è¡¨ä»»åŠ¡
   * æ ¹æ®é¡¹ç›®ç»“æ„å’Œä¾èµ–è‡ªåŠ¨ç”Ÿæˆä¼˜åŒ–çš„ä¿ç•™è§„åˆ™
   */
  open class GenerateMultiDexKeepTask : DefaultTask() {
      
      @Input
      lateinit var variantName: String
      
      @OutputFile
      lateinit var outputFile: File
      
      @TaskAction
      fun generateKeepList() {
          println("ğŸ“ ä¸ºå˜ä½“ '$variantName' ç”Ÿæˆ MultiDex ä¿ç•™åˆ—è¡¨...")
          
          val keepRules = buildString {
              appendLine("# ======== è‡ªåŠ¨ç”Ÿæˆçš„ MultiDex ä¿ç•™è§„åˆ™ ========")
              appendLine("# å˜ä½“: $variantName")
              appendLine("# ç”Ÿæˆæ—¶é—´: ${java.util.Date()}")
              appendLine()
              
              // åŸºç¡€ä¿ç•™è§„åˆ™
              appendLine("# === åŸºç¡€æ¡†æ¶ç±» ===")
              appendLine("-keep class com.kedacom.ovopark.BaseApplication")
              appendLine("-keep class com.kedacom.ovopark.MainActivity")
              appendLine("-keep class com.kedacom.ovopark.SplashActivity")
              appendLine()
              
              // MultiDex æ ¸å¿ƒ
              appendLine("# === MultiDex æ ¸å¿ƒ ===")
              appendLine("-keep class androidx.multidex.**")
              appendLine("-keep class android.support.multidex.**")
              appendLine()
              
              // åˆ†æé¡¹ç›®ä¾èµ–ï¼Œæ·»åŠ å…³é”®ä¾èµ–çš„ä¿ç•™è§„åˆ™
              val dependencies = project.configurations.getByName("implementation").dependencies
              
              // è·¯ç”±æ¡†æ¶
              if (dependencies.any { it.name.contains("arouter", ignoreCase = true) }) {
                  appendLine("# === ARouter è·¯ç”±æ¡†æ¶ ===")
                  appendLine("-keep class com.alibaba.android.arouter.**")
                  appendLine()
              }
              
              // ç½‘ç»œæ¡†æ¶
              if (dependencies.any { it.name.contains("okhttp", ignoreCase = true) }) {
                  appendLine("# === ç½‘ç»œæ¡†æ¶ ===")
                  appendLine("-keep class okhttp3.**")
                  appendLine("-keep class okio.**")
                  appendLine()
              }
              
              // JSONè§£æ
              if (dependencies.any { it.name.contains("gson", ignoreCase = true) }) {
                  appendLine("# === JSON è§£æ ===")
                  appendLine("-keep class com.google.gson.**")
                  appendLine()
              }
              
              if (dependencies.any { it.name.contains("fastjson", ignoreCase = true) }) {
                  appendLine("-keep class com.alibaba.fastjson.**")
                  appendLine()
              }
              
              // æ¨é€æœåŠ¡
              if (dependencies.any { it.name.contains("jpush", ignoreCase = true) }) {
                  appendLine("# === æ¨é€æœåŠ¡ ===")
                  appendLine("-keep class cn.jpush.**")
                  appendLine("-keep class cn.jiguang.**")
                  appendLine()
              }
              
              // æ•°æ®åº“
              if (dependencies.any { it.name.contains("greendao", ignoreCase = true) }) {
                  appendLine("# === æ•°æ®åº“ ===")
                  appendLine("-keep class org.greenrobot.greendao.**")
                  appendLine()
              }
              
              // å›¾ç‰‡åŠ è½½
              if (dependencies.any { it.name.contains("fresco", ignoreCase = true) }) {
                  appendLine("# === å›¾ç‰‡åŠ è½½æ¡†æ¶ ===")
                  appendLine("-keep class com.facebook.fresco.**")
                  appendLine("-keep class com.facebook.imagepipeline.**")
                  appendLine()
              }
              
              // å¼‚å¸¸ä¸ŠæŠ¥
              if (dependencies.any { it.name.contains("bugly", ignoreCase = true) }) {
                  appendLine("# === å¼‚å¸¸ä¸ŠæŠ¥ ===")
                  appendLine("-keep class com.tencent.bugly.**")
                  appendLine()
              }
              
              // åˆ†ææºç ç»“æ„ï¼Œæ·»åŠ å…³é”®ä¸šåŠ¡ç±»
              appendLine("# === å…³é”®ä¸šåŠ¡ç±» ===")
              val srcDir = File(project.projectDir, "src/main/java/com/kedacom/ovopark")
              if (srcDir.exists()) {
                  val importantPackages = findImportantPackages(srcDir)
                  importantPackages.forEach { pkg ->
                      appendLine("-keep class com.kedacom.ovopark.$pkg.**")
                  }
              }
              appendLine()
              
              appendLine("# === è‡ªå®šä¹‰é¡¹ç›®åŸºç¡€ç±» ===")
              appendLine("-keep class com.ovopark.dblib.**")
              appendLine("-keep class com.kedacom.ovopark.base.**")
              appendLine("-keep class com.kedacom.ovopark.utils.**")
              appendLine("-keep class com.kedacom.ovopark.common.**")
              appendLine("-keep class com.kedacom.ovopark.constants.**")
          }
          
          outputFile.parentFile?.mkdirs()
          outputFile.writeText(keepRules)
          
          println("âœ… MultiDex ä¿ç•™åˆ—è¡¨å·²ç”Ÿæˆ: ${outputFile.absolutePath}")
          println("ğŸ“Š åŒ…å« ${keepRules.lines().count { it.startsWith("-keep") }} æ¡ä¿ç•™è§„åˆ™")
      }
      
      /**
       * åˆ†ææºç ç›®å½•ï¼Œæ‰¾å‡ºé‡è¦çš„åŒ…
       */
      private fun findImportantPackages(srcDir: File): List<String> {
          val importantPackages = mutableListOf<String>()
          
          // æŸ¥æ‰¾åŒ…å«Applicationã€Activityã€Serviceç­‰å…³é”®ç±»çš„åŒ…
          srcDir.walkTopDown()
              .filter { it.isDirectory }
              .forEach { dir ->
                  val relativePath = dir.relativeTo(srcDir).path.replace(File.separator, ".")
                  
                  // æ£€æŸ¥æ˜¯å¦åŒ…å«é‡è¦çš„ç±»æ–‡ä»¶
                  val hasImportantClasses = dir.listFiles()?.any { file ->
                      if (file.isFile && (file.extension == "java" || file.extension == "kt")) {
                          val content = try {
                              file.readText()
                          } catch (e: Exception) {
                              ""
                          }
                          // æ£€æŸ¥æ˜¯å¦åŒ…å«å…³é”®çš„ç±»å®šä¹‰
                          content.contains("extends Application") ||
                          content.contains("extends Activity") ||
                          content.contains("extends Service") ||
                          content.contains("extends BroadcastReceiver") ||
                          content.contains("@Override") && content.contains("onCreate") ||
                          content.contains("class.*Activity") ||
                          content.contains("class.*Service") ||
                          content.contains("class.*Application")
                      } else false
                  } ?: false
                  
                  if (hasImportantClasses && relativePath.isNotEmpty()) {
                      importantPackages.add(relativePath)
                  }
              }
          
          // æ·»åŠ ä¸€äº›é€šç”¨çš„é‡è¦åŒ…å
          val commonImportantPackages = listOf(
              "activity", "service", "receiver", "provider", 
              "fragment", "dialog", "widget", "adapter",
              "manager", "helper", "config", "api"
          )
          
          commonImportantPackages.forEach { pkg ->
              val pkgDir = File(srcDir, pkg)
              if (pkgDir.exists() && !importantPackages.contains(pkg)) {
                  importantPackages.add(pkg)
              }
          }
          
          return importantPackages.distinct().take(10) // é™åˆ¶æ•°é‡é¿å…è¿‡å¤š
      }
  } 
  ```

å¯åŠ¨æ€§èƒ½ç›‘æ§ä»»åŠ¡ï¼Œåˆ†æé¡¹ç›®ç»“æ„ï¼Œæä¾›å¯åŠ¨ä¼˜åŒ–å»ºè®®

- ```
  package com.ovopark.plugin
  
  import org.gradle.api.DefaultTask
  import org.gradle.api.tasks.Input
  import org.gradle.api.tasks.TaskAction
  import java.io.File
  
  /**
   * å¯åŠ¨æ€§èƒ½ç›‘æ§ä»»åŠ¡
   * åˆ†æé¡¹ç›®ç»“æ„ï¼Œæä¾›å¯åŠ¨ä¼˜åŒ–å»ºè®®
   */
  open class StartupMonitoringTask : DefaultTask() {
      
      @Input
      lateinit var variantName: String
      
      @TaskAction
      fun monitor() {
          println("ğŸ“± å¼€å§‹åˆ†æå˜ä½“ '$variantName' çš„å¯åŠ¨æ€§èƒ½...")
          
          analyzeApplicationClass()
          analyzeModuleDependencies()
          analyzeResourceUsage()
          generateStartupOptimizationReport()
          
          println("âœ… å¯åŠ¨æ€§èƒ½åˆ†æå®Œæˆ")
      }
      
      private fun analyzeApplicationClass() {
          println("ğŸ” åˆ†æ Application ç±»...")
          
          val applicationFile = File(project.projectDir, "src/main/java/com/kedacom/ovopark/BaseApplication.java")
          if (applicationFile.exists()) {
              val content = applicationFile.readText()
              val lines = content.lines()
              val onCreateMethod = extractOnCreateMethod(lines)
              
              if (onCreateMethod.isNotEmpty()) {
                  val heavyOperations = findHeavyOperations(onCreateMethod)
                  if (heavyOperations.isNotEmpty()) {
                      println("âš ï¸ Application.onCreate() ä¸­å‘ç°å¯èƒ½å½±å“å¯åŠ¨çš„æ“ä½œï¼š")
                      heavyOperations.forEach { operation ->
                          println("   â€¢ $operation")
                      }
                  }
              }
          }
      }
      
      private fun extractOnCreateMethod(lines: List<String>): List<String> {
          val onCreateLines = mutableListOf<String>()
          var inOnCreate = false
          var braceCount = 0
          
          for (line in lines) {
              val trimmedLine = line.trim()
              
              if (trimmedLine.contains("public void onCreate(") || trimmedLine.contains("override fun onCreate(")) {
                  inOnCreate = true
                  onCreateLines.add(line)
                  if (trimmedLine.contains("{")) {
                      braceCount++
                  }
                  continue
              }
              
              if (inOnCreate) {
                  onCreateLines.add(line)
                  braceCount += trimmedLine.count { it == '{' }
                  braceCount -= trimmedLine.count { it == '}' }
                  
                  if (braceCount <= 0) {
                      break
                  }
              }
          }
          
          return onCreateLines
      }
      
      private fun findHeavyOperations(onCreateMethod: List<String>): List<String> {
          val heavyOperations = mutableListOf<String>()
          
          for (line in onCreateMethod) {
              val trimmedLine = line.trim()
              
              // æ£€æŸ¥å¯èƒ½çš„é‡æ“ä½œ
              when {
                  trimmedLine.contains("init", ignoreCase = true) && 
                  (trimmedLine.contains("Fresco") || trimmedLine.contains("ImagePipeline")) -> {
                      heavyOperations.add("å›¾ç‰‡åŠ è½½æ¡†æ¶åˆå§‹åŒ– (Fresco) - å»ºè®®å¼‚æ­¥åˆå§‹åŒ–")
                  }
                  
                  trimmedLine.contains("ARouter.init") -> {
                      heavyOperations.add("è·¯ç”±æ¡†æ¶åˆå§‹åŒ– - å¯ä»¥å»¶è¿Ÿåˆ°å®é™…ä½¿ç”¨æ—¶")
                  }
                  
                  trimmedLine.contains("MMKV.initialize") -> {
                      heavyOperations.add("MMKV åˆå§‹åŒ– - å»ºè®®ä½¿ç”¨æ‡’åŠ è½½")
                  }
                  
                  trimmedLine.contains("OssCreateManager") -> {
                      heavyOperations.add("OSS æœåŠ¡åˆå§‹åŒ– - å»ºè®®å»¶è¿Ÿåˆ°éœ€è¦æ—¶å†åˆå§‹åŒ–")
                  }
                  
                  trimmedLine.contains("registerActivityLifecycleCallbacks") -> {
                      heavyOperations.add("Activity ç”Ÿå‘½å‘¨æœŸç›‘å¬æ³¨å†Œ - æ­£å¸¸ï¼Œä½†ç¡®ä¿å›è°ƒé€»è¾‘ç®€å•")
                  }
                  
                  trimmedLine.contains("Thread") || trimmedLine.contains("async") -> {
                      heavyOperations.add("çº¿ç¨‹æ“ä½œ - ç¡®ä¿ä¸é˜»å¡ä¸»çº¿ç¨‹")
                  }
                  
                  trimmedLine.contains("database", ignoreCase = true) || 
                  trimmedLine.contains("db", ignoreCase = true) -> {
                      heavyOperations.add("æ•°æ®åº“æ“ä½œ - å»ºè®®å¼‚æ­¥æ‰§è¡Œ")
                  }
                  
                  trimmedLine.contains("SharedPreferences") || trimmedLine.contains("EasyDataStore") -> {
                      heavyOperations.add("æ•°æ®å­˜å‚¨æ“ä½œ - å»ºè®®å‡å°‘å¯åŠ¨æ—¶çš„å­˜å‚¨æ“ä½œ")
                  }
              }
          }
          
          return heavyOperations
      }
      
      private fun analyzeModuleDependencies() {
          println("ğŸ“¦ åˆ†ææ¨¡å—ä¾èµ–...")
          
          val dependencies = project.configurations.getByName("implementation").dependencies
          val moduleCount = dependencies.size
          
          println("ğŸ“Š æ€»ä¾èµ–æ•°é‡: $moduleCount")
          
          // åˆ†æä¾èµ–ç±»å‹
          val externalDeps = dependencies.filter { !it.name.startsWith(":") }
          val internalDeps = dependencies.filter { it.name.startsWith(":") }
          
          println("   - å¤–éƒ¨ä¾èµ–: ${externalDeps.size}")
          println("   - å†…éƒ¨æ¨¡å—: ${internalDeps.size}")
          
          if (internalDeps.size > 40) {
              println("âš ï¸ å†…éƒ¨æ¨¡å—æ•°é‡è¾ƒå¤šï¼Œå»ºè®®è€ƒè™‘ï¼š")
              println("   1. æŒ‰éœ€åŠ è½½æ¨¡å—")
              println("   2. å»¶è¿Ÿåˆå§‹åŒ–éæ ¸å¿ƒæ¨¡å—")
              println("   3. ä½¿ç”¨åŠ¨æ€ç‰¹æ€§æ¨¡å—")
          }
          
          // æ£€æŸ¥å¤§å‹ä¾èµ–
          val heavyDependencies = externalDeps.filter { dep ->
              listOf("fresco", "retrofit", "okhttp", "glide", "lottie", "webrtc").any { 
                  dep.name.contains(it, ignoreCase = true) 
              }
          }
          
          if (heavyDependencies.isNotEmpty()) {
              println("ğŸ“š æ£€æµ‹åˆ°å¤§å‹ä¾èµ–åº“:")
              heavyDependencies.forEach { dep ->
                  println("   - ${dep.name}")
              }
              println("ğŸ’¡ å»ºè®®ï¼šè€ƒè™‘æŒ‰éœ€åŠ è½½æˆ–å¯»æ‰¾è½»é‡çº§æ›¿ä»£æ–¹æ¡ˆ")
          }
      }
      
      private fun analyzeResourceUsage() {
          println("ğŸ¨ åˆ†æèµ„æºä½¿ç”¨...")
          
          val resDir = File(project.projectDir, "src/main/res")
          if (resDir.exists()) {
              val drawableDir = File(resDir, "drawable")
              val mipmapDir = File(resDir, "mipmap")
              val layoutDir = File(resDir, "layout")
              
              var imageCount = 0
              var totalImageSize = 0L
              
              listOf(drawableDir, mipmapDir).forEach { dir ->
                  if (dir.exists()) {
                      dir.listFiles()?.forEach { file ->
                          if (file.isFile && file.extension in listOf("png", "jpg", "jpeg", "webp")) {
                              imageCount++
                              totalImageSize += file.length()
                          }
                      }
                  }
              }
              
              val layoutCount = layoutDir.listFiles()?.size ?: 0
              
              println("ğŸ“Š èµ„æºç»Ÿè®¡:")
              println("   - å›¾ç‰‡èµ„æº: $imageCount ä¸ª")
              println("   - å›¾ç‰‡æ€»å¤§å°: ${totalImageSize / 1024 / 1024} MB")
              println("   - å¸ƒå±€æ–‡ä»¶: $layoutCount ä¸ª")
              
              if (totalImageSize > 50 * 1024 * 1024) { // 50MB
                  println("âš ï¸ å›¾ç‰‡èµ„æºè¾ƒå¤§ï¼Œå»ºè®®ï¼š")
                  println("   1. å‹ç¼©å›¾ç‰‡èµ„æº")
                  println("   2. ä½¿ç”¨ WebP æ ¼å¼")
                  println("   3. è€ƒè™‘ä»ç½‘ç»œåŠ è½½éå…³é”®å›¾ç‰‡")
              }
          }
      }
      
      private fun generateStartupOptimizationReport() {
          println("ğŸ“„ ç”Ÿæˆå¯åŠ¨ä¼˜åŒ–æŠ¥å‘Š...")
          
          val reportFile = File(project.buildDir, "reports/startup-optimization-$variantName.md")
          reportFile.parentFile?.mkdirs()
          
          val report = buildString {
              appendLine("# å¯åŠ¨æ€§èƒ½ä¼˜åŒ–æŠ¥å‘Š")
              appendLine()
              appendLine("**å˜ä½“**: $variantName")
              appendLine("**ç”Ÿæˆæ—¶é—´**: ${java.util.Date()}")
              appendLine()
              
              appendLine("## ğŸ¯ ä¼˜åŒ–å»ºè®®")
              appendLine()
              
              appendLine("### 1. Application ä¼˜åŒ–")
              appendLine("- å°†éå…³é”®åˆå§‹åŒ–æ“ä½œç§»åˆ°å¼‚æ­¥çº¿ç¨‹")
              appendLine("- ä½¿ç”¨æ‡’åŠ è½½æ¨¡å¼ï¼Œå»¶è¿Ÿåˆ°å®é™…éœ€è¦æ—¶å†åˆå§‹åŒ–")
              appendLine("- å‡å°‘ Application.onCreate() ä¸­çš„åŒæ­¥æ“ä½œ")
              appendLine()
              
              appendLine("### 2. ä¾èµ–ä¼˜åŒ–")
              val dependencies = project.configurations.getByName("implementation").dependencies
              appendLine("- å½“å‰ä¾èµ–æ•°é‡: ${dependencies.size}")
              appendLine("- è€ƒè™‘ç§»é™¤æœªä½¿ç”¨çš„ä¾èµ–")
              appendLine("- å¯¹äºå¤§å‹åº“ï¼Œè€ƒè™‘æŒ‰éœ€å¼•å…¥æˆ–å¯»æ‰¾è½»é‡çº§æ›¿ä»£")
              appendLine()
              
              appendLine("### 3. èµ„æºä¼˜åŒ–")
              appendLine("- å‹ç¼©å›¾ç‰‡èµ„æºï¼Œä½¿ç”¨ WebP æ ¼å¼")
              appendLine("- ç§»é™¤æœªä½¿ç”¨çš„èµ„æºæ–‡ä»¶")
              appendLine("- ä½¿ç”¨çŸ¢é‡å›¾æ›¿ä»£ä½å›¾")
              appendLine()
              
              appendLine("### 4. Dex ä¼˜åŒ–")
              appendLine("- å·²å¯ç”¨ MultiDex ä¼˜åŒ–")
              appendLine("- å…³é”®ç±»å·²é…ç½®åœ¨ä¸» Dex ä¸­")
              appendLine("- å»ºè®®å®šæœŸæ¸…ç†æ— ç”¨ä»£ç ")
              appendLine()
              
              appendLine("### 5. æ„å»ºä¼˜åŒ–")
              appendLine("- å¯ç”¨å¢é‡ç¼–è¯‘")
              appendLine("- ä½¿ç”¨æ„å»ºç¼“å­˜")
              appendLine("- ä¼˜åŒ– Gradle é…ç½®")
              appendLine()
              
              appendLine("## ğŸ“Š æ€§èƒ½æŒ‡æ ‡ç›®æ ‡")
              appendLine("- å†·å¯åŠ¨æ—¶é—´: < 3ç§’")
              appendLine("- æ¸©å¯åŠ¨æ—¶é—´: < 1.5ç§’")
              appendLine("- çƒ­å¯åŠ¨æ—¶é—´: < 0.5ç§’")
              appendLine()
              
              appendLine("## ğŸ”§ å®æ–½æ­¥éª¤")
              appendLine("1. ä¼˜åŒ– BaseApplication çš„ onCreate() æ–¹æ³•")
              appendLine("2. å®æ–½æ¨¡å—æŒ‰éœ€åŠ è½½")
              appendLine("3. æ·»åŠ å¯åŠ¨æ—¶é—´ç›‘æ§")
              appendLine("4. å®šæœŸè¿›è¡Œæ€§èƒ½æµ‹è¯•")
              appendLine()
              
              appendLine("---")
              appendLine("*æ­¤æŠ¥å‘Šç”± OvoPark ä¼˜åŒ–æ’ä»¶è‡ªåŠ¨ç”Ÿæˆ*")
          }
          
          reportFile.writeText(report)
          println("ğŸ“‹ å¯åŠ¨ä¼˜åŒ–æŠ¥å‘Šå·²ç”Ÿæˆ: ${reportFile.absolutePath}")
      }
  } 
  ```

  