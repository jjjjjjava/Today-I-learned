[toc]

## 01.åŠŸèƒ½æ¦‚è¿°

- **[ä¼˜å…ˆçº§] **
  - [ ] âš ï¸ é˜»æ–­ (Blocker)ï¼šç³»ç»Ÿå´©æºƒã€æ ¸å¿ƒåŠŸèƒ½å®Œå…¨ä¸å¯ç”¨
  - [ ] ðŸ”´ ä¸¥é‡ (Critical)ï¼šæ ¸å¿ƒåŠŸèƒ½å—æŸï¼Œæ— å¯ç”¨æ›¿ä»£æ–¹æ¡ˆ
  - [ ] ðŸŸ  é«˜ (High)ï¼šä¸»è¦åŠŸèƒ½å—å½±å“ï¼Œä½†æœ‰ä¸´æ—¶è§£å†³æ–¹æ¡ˆ
  - [ ] ðŸŸ¡ ä¸­ (Medium)ï¼šæ¬¡è¦åŠŸèƒ½é—®é¢˜ï¼Œå½±å“ç”¨æˆ·ä½“éªŒ
  - [ ] ðŸŸ¢ ä½Ž (Low)ï¼šç•Œé¢é—®é¢˜æˆ–è½»å¾®å¼‚å¸¸ï¼Œä¸å½±å“åŠŸèƒ½
- **é—®é¢˜ç®€è¦æè¿°**
  - **Bug ID**ï¼š`BUG-20240702-001`  
  - **å‘çŽ°æ—¥æœŸ**ï¼š2025-07-02
  - **å½±å“ç‰ˆæœ¬**ï¼šv0.1.0 - v0.3.0
  - **æäº¤äºº**ï¼š@panruiqi
  - **çŠ¶æ€**ï¼š
    - [x] âŒ› ä¿®å¤ä¸­ /
    - [ ] âœ… å·²è§£å†³ / 
    - [ ] âŒ æ— æ³•å¤çŽ°  

- **é—®é¢˜çŽ°è±¡**
  - 
- **çŽ¯å¢ƒç‰¹å¾**
  - è®¾å¤‡åž‹å·: Pixel 6 Pro / Xiaomi 13
  - OSç‰ˆæœ¬: Android 14 (API 34)
  - ç½‘ç»œçŽ¯å¢ƒ: å…¬å¸å†…ç½‘/WiFi
  - ç”¨æˆ·è´¦æˆ·: primary_user (ID:0)
  - è§¦å‘æ—¶æœº: ç³»ç»Ÿå¯åŠ¨åŽ5åˆ†é’Ÿå†…

## 02.é—®é¢˜åˆ†æž

### 2.1 åˆæ­¥åˆ†æž

æ‰§è¡Œä¸‹è¿°å‘½ä»¤ï¼ŒæŠ¥é”™å¯åŠ¨æ—¥å¿—ï¼š`D:\Develop\Android\CloudPos> adb logcat -v time > C:\Users\panruiqi\Desktop\boot_log.txt`

æŸ¥çœ‹æ—¥å¿—ï¼š

- æœç´¢ovoparkï¼Œæ—¥å¿—å¦‚ä¸‹ï¼š

- ```
  07-03 21:05:34.677 W/PackageSettings(  502): Skipping PackageSetting{a85dad0 com.ovopark.cloudpos/10098} due to missing metadata
  ```

- åˆ†æžï¼šAndroid ç³»ç»Ÿåœ¨å¯åŠ¨æ—¶æ— æ³•æ‰¾åˆ° ovopark åº”ç”¨çš„å¿…è¦å…ƒæ•°æ®ï¼Œå¯¼è‡´è·³è¿‡è¯¥åº”ç”¨çš„åˆå§‹åŒ–ã€‚è¿™ä¼šå¯¼è‡´ï¼š
  - åº”ç”¨åœ¨ç³»ç»Ÿä¸­"ä¸å¯è§"ï¼Œå°±åƒè¢«åˆ é™¤äº†ä¸€æ ·
  - åº”ç”¨æ— æ³•æ­£å¸¸å¯åŠ¨æˆ–è¿è¡Œ
  - æ¡Œé¢å›¾æ ‡å¯èƒ½æ¶ˆå¤±

æ£€æµ‹åº”ç”¨çŠ¶æ€

- æ‰§è¡Œ `adb shell dumpsys package com.ovopark.cloudpos`

- ```
  D:\Develop\Android\CloudPos> adb shell dumpsys package com.ovopark.cloudpos
  Domain verification status:
  Failure printing domain verification information
  
  Permissions:
    Permission [com.ovopark.cloudpos.DYNAMIC_RECEIVER_NOT_EXPORTED_PERMISSION] (a908a2c):
      sourcePackage=com.ovopark.cloudpos
      uid=0 gids=[] type=0 prot=signature
      perm=PermissionInfo{3ac6cf5 com.ovopark.cloudpos.DYNAMIC_RECEIVER_NOT_EXPORTED_PERMISSION}
      flags=0x0
  
  Key Set Manager:
    [com.ovopark.cloudpos]
        Signing KeySets: 31
  
  Packages:
    Package [com.ovopark.cloudpos] (41b3a8a):
      userId=10098
      pkg=null
      codePath=/data/app/~~HODkIO5boUGJS-rerYZ_vw==/com.ovopark.cloudpos-VQOa-fdTv6ZLexrJOVvSLQ==
      resourcePath=/data/app/~~HODkIO5boUGJS-rerYZ_vw==/com.ovopark.cloudpos-VQOa-fdTv6ZLexrJOVvSLQ==
      legacyNativeLibraryDir=/data/app/~~HODkIO5boUGJS-rerYZ_vw==/com.ovopark.cloudpos-VQOa-fdTv6ZLexrJOVvSLQ==/lib
      extractNativeLibs=false
      primaryCpuAbi=null
      secondaryCpuAbi=null
      cpuAbiOverride=null
      versionCode=1
      timeStamp=2025-07-03 21:05:05
      lastUpdateTime=2025-07-03 21:05:05
      packageSource=0
      signatures=PackageSignatures{c2a28fb version:2, signatures:[17735236], past signatures:[]}
      installPermissionsFixed=false
      pkgFlags=[ ]
      User 0: ceDataInode=0 installed=true hidden=false suspended=false distractionFlags=0 stopped=true notLaunched=true enabled=0 instant=false virtual=false
        installReason=0
        firstInstallTime=2025-07-03 21:05:05
        uninstallReason=0
        runtime permissions:
  
  Queries:
    system apps queryable: false
    queries via forceQueryable:
    queries via package name:
    queries via component:
    queryable via interaction:
      User 0:
    queryable via uses-library:
  
  Dexopt state:
    BgDexopt state:
      enabled:true
      mDexOptThread:null
      mDexOptCancellingThread:null
      mFinishedPostBootUpdate:false
      mLastExecutionStatus:0
      mLastExecutionStartTimeMs:0
      mLastExecutionDurationIncludingSleepMs:0
      mLastExecutionStartUptimeMs:0
      mLastExecutionDurationMs:0
      now:344353
      mLastCancelledPackages:
      mFailedPackageNamesPrimary:
      mFailedPackageNamesSecondary:
  
  Compiler stats:
  PS D:\Develop\Android\CloudPos>
  
  ```

- **æ ¸å¿ƒé—®é¢˜ï¼š`pkg=null`**

  ```
  Package [com.ovopark.cloudpos] (41b3a8a):
    userId=10098
    pkg=null  <-- è¿™æ˜¯å…³é”®é—®é¢˜ï¼
  ```

  - è¿™ä¸ª `pkg=null` è¡¨ç¤º Android ç³»ç»Ÿæ— æ³•æ­£ç¡®åŠ è½½è¯¥åº”ç”¨çš„åŒ…ä¿¡æ¯
  - å¯¼è‡´åŽŸå› é€šå¸¸æ˜¯åŒ…å…ƒæ•°æ®æŸåæˆ–æ— æ³•è§£æž

- **åº”ç”¨å¤„äºŽéžæ´»è·ƒçŠ¶æ€**

  ```
  User 0: ... stopped=true notLaunched=true enabled=0
  ```

  - `enabled=0`ï¼šåº”ç”¨è¢«ç¦ç”¨
  - `stopped=true`ï¼šåº”ç”¨å¤„äºŽåœæ­¢çŠ¶æ€
  - `notLaunched=true`ï¼šåº”ç”¨ä»Žæœªè¢«å¯åŠ¨è¿‡

æ—¶é—´çº¿æ¢³ç†

- ç³»ç»Ÿå¯åŠ¨

  - 07-03 21:05:11.881 - ç³»ç»Ÿå¼€å§‹å¯åŠ¨ï¼ˆLinux kernel å¯åŠ¨ï¼‰
  - 07-03 21:05:12 - å„ç§ç³»ç»ŸæœåŠ¡å¼€å§‹åˆå§‹åŒ–

- åŒ…ç®¡ç†é—®é¢˜å‡ºçŽ°
  - 07-03 21:05:34.677\- ç¬¬ä¸€ä¸ªè­¦å‘Šï¼š

  - ```
     W/PackageSettings( 502): Skipping PackageSetting{a85dad0 com.ovopark.cloudpos/10098} due to missing metadata
    ```

- å…³é”®é”™è¯¯ç¡®è®¤
  - 07-03 21:05:39.306 \- æ ¸å¿ƒé—®é¢˜ï¼š

  - ```
    W/PackageManager( 502): Odd, missing scanned package com.ovopark.cloudpos
    ```

-  å¤‡ä»½æ¢å¤å°è¯•å¤±è´¥
  - 07-03 21:05:41.873 \- å¤‡ä»½æœåŠ¡æç¤ºï¼š

  - ```
    I/BackupManagerService( 502): [UserID:0] Package com.ovopark.cloudpos not installed; dropping from full backup
    ```

- ç³»ç»Ÿè‡ªåŠ¨ä¿®å¤
  - 07-03 21:05:54.329 \- å¼ºåˆ¶åœæ­¢åº”ç”¨ï¼š

  - ```
     I/ActivityManager( 502): Force stopping com.ovopark.cloudpos appid=10098 user=-1: installPackageLI
    ```

- 07-03 21:05:54.332 \- åŒ…è·¯å¾„æ›´æ–°ï¼š

  - ```
     I/PackageManager( 502): Update package com.ovopark.cloudpos code path from /data/app/~~HODkIO5boUGJS-rerYZ_vw==/com.ovopark.cloudpos-VQOa-fdTv6ZLexrJOVvSLQ== to /data/app/~~OPQuqViPoLxNkXX3H7Axpw==/com.ovopark.cloudpos-BWbHci_6oJZCXpGRG6tbaw==; Retain data and using new
    ```

### 2.2 æ ¹æœ¬åŽŸå› æŽ¨ç†

è¿™æ˜¯ä¸€ä¸ªå…¸åž‹çš„ Android æ–­ç”µå¯¼è‡´åŒ…ç®¡ç†ç³»ç»Ÿä¸ä¸€è‡´çš„é—®é¢˜ã€‚ç³»ç»Ÿçš„è‡ªæˆ‘ä¿®å¤æœºåˆ¶æˆåŠŸæ¢å¤äº†åº”ç”¨ï¼Œä½†åœ¨çŸ­æ—¶é—´å†…åº”ç”¨ç¡®å®žå¤„äºŽ"æ¶ˆå¤±"çŠ¶æ€ã€‚

ä¸ºä»€ä¹ˆï¼Ÿæ€Žä¹ˆåˆ¤æ–­çš„ï¼Ÿ

åˆæ­¥çš„åˆ¤æ–­é€»è¾‘é“¾

- ```
  æ–­ç”µ â†’ æ–‡ä»¶ç³»ç»Ÿä¸ä¸€è‡´ â†’ å…ƒæ•°æ®ä¸¢å¤± â†’ åŒ…ç®¡ç†å™¨æ— æ³•è¯†åˆ« â†’ è‡ªåŠ¨ä¿®å¤
  ```

è¯æ®

- æ–‡ä»¶ç³»ç»Ÿå¼‚å¸¸å…³æœº

- å…³é”®æ—¥å¿—è¯æ®ï¼š

  - ```
    07-03 21:05:13.305 I/init (1): [libfs_mgr]Filesystem on /dev/block/by-name/metadata was not cleanly shutdown; state flags: 0x1, incompat feature flags: 0x46
    ```

  - ```
    07-03 21:05:13.311 I/EXT4-fs (mmcblk2p11)(1): recovery complete
    ```

- è¿™äº›è¯æ®è¡¨æ˜Žï¼š

  - æ–‡ä»¶ç³»ç»Ÿæ²¡æœ‰å¹²å‡€å…³é—­ï¼šwas not cleanly shutdown æ˜Žç¡®æŒ‡å‡ºç³»ç»Ÿå¼‚å¸¸å…³æœº
  - æ‰§è¡Œäº†æ–‡ä»¶ç³»ç»Ÿæ¢å¤ï¼šä¸¤ä¸ªåˆ†åŒºéƒ½æ‰§è¡Œäº† recovery complete
  - çŠ¶æ€æ ‡å¿—å¼‚å¸¸ï¼šstate flags: 0x1 è¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿæ ‡è®°ä¸º"è„"çŠ¶æ€

åˆ¤æ–­ä¾æ®çš„åŽŸç†

- è„ä½ï¼š
  - æ­£å¸¸å…³æœºï¼šæ–‡ä»¶ç³»ç»Ÿæ ‡è®°ä¸º"å¹²å‡€"(clean)
  - å¼‚å¸¸æ–­ç”µï¼šæ–‡ä»¶ç³»ç»Ÿä¿æŒ"è„"(dirty)çŠ¶æ€
- EXT4åœ¨æŒ‚è½½æ—¶æ£€æµ‹åˆ°æ–‡ä»¶ç³»ç»Ÿè„æ ‡è®°
  - è‡ªåŠ¨æ‰§è¡Œ fsckï¼ˆæ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥ï¼‰
  - æ¢å¤æ—¥å¿—ä¸­æœªæäº¤çš„äº‹åŠ¡
- æ£€æµ‹åˆ°ä¸ä¸€è‡´åŽçš„å¤„ç†æµç¨‹ï¼š
  - å‘çŽ°é—®é¢˜ï¼šPackageManageræ‰«ææ—¶å‘çŽ°ä¸ä¸€è‡´
  - æ ‡è®°ä¿®å¤ï¼šå°†æœ‰é—®é¢˜çš„åŒ…æ ‡è®°ä¸ºéœ€è¦ä¿®å¤
  - å¼ºåˆ¶é‡è£…ï¼šForce stopping + installPackageLI
  - è·¯å¾„é‡åˆ†é…ï¼šåˆ†é…æ–°çš„éšæœºè·¯å¾„é¿å…å†²çª

### 2.3 è¿›ä¸€æ­¥åˆ†æž

ä¸ºä»€ä¹ˆæ–­ç”µå¯¼è‡´çš„æ–‡ä»¶ç³»ç»Ÿè„ä½ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶ç³»ç»Ÿä¸ä¸€è‡´ï¼Œä¼šå¯¼è‡´åŒ…ç®¡ç†å‡ºçŽ°é”™è¯¯ï¼Ÿ

- AndroidåŒ…ç®¡ç†ç³»ç»Ÿçš„æ ¸å¿ƒæ–‡ä»¶ç»“æž„

  - ```
    /data/system/
    â”œâ”€â”€ packages.xml          # åŒ…æ³¨å†Œä¿¡æ¯ï¼ˆæ ¸å¿ƒç´¢å¼•ï¼‰
    â”œâ”€â”€ packages.list         # åŒ…åˆ—è¡¨ç¼“å­˜
    â”œâ”€â”€ package-restrictions.xml # åŒ…é™åˆ¶é…ç½®
    â””â”€â”€ users/0/
        â”œâ”€â”€ package-restrictions.xml # ç”¨æˆ·çº§åŒ…é™åˆ¶
        â””â”€â”€ runtime-permissions.xml  # è¿è¡Œæ—¶æƒé™
    
    /data/app/
    â”œâ”€â”€ ~~RandomHash~~/
    â”‚   â”œâ”€â”€ com.ovopark.cloudpos-RandomString==/ # APKå®žé™…æ–‡ä»¶
    â”‚   â”‚   â”œâ”€â”€ base.apk
    â”‚   â”‚   â”œâ”€â”€ lib/
    â”‚   â”‚   â””â”€â”€ oat/          # é¢„ç¼–è¯‘ä»£ç 
    â”‚   â””â”€â”€ metadata/         # åŒ…å…ƒæ•°æ®
    â””â”€â”€ ...
    
    /data/data/com.ovopark.cloudpos/  # åº”ç”¨ç§æœ‰æ•°æ®
    ```

- æ–‡ä»¶ç³»ç»Ÿä¸ä¸€è‡´ â†’ åŒ…ç®¡ç†é”™è¯¯çš„å…·ä½“é“¾è·¯

  - æ­£å¸¸çš„åŒ…ç®¡ç†åŒæ­¥æœºåˆ¶

  - ```
    å®‰è£…è¿‡ç¨‹çš„åŽŸå­æ€§æ“ä½œï¼š
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 1.å†™å…¥APKæ–‡ä»¶    â”‚ â”€â”€â”€â†’ â”‚ 2.æ›´æ–°packages.xml â”‚ â”€â”€â”€â†’ â”‚ 3.åˆ·æ–°å†…å­˜ç¼“å­˜    â”‚
    â”‚   (ç‰©ç†æ–‡ä»¶)     â”‚    â”‚   (æ³¨å†Œä¿¡æ¯)      â”‚    â”‚   (PackageManager) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    ```

  - æ–­ç”µæ—¶çš„ä¸­æ–­ç‚¹

  - ```
    æ–­ç”µå¯èƒ½å‘ç”Ÿçš„æ—¶æœºï¼š
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ âœ… APKå·²å†™å…¥     â”‚ â”€â”€â”€â†’ â”‚ âŒ XMLå†™å…¥ä¸­æ–­   â”‚ â”€â”€â”€â†’ â”‚ âŒ ç¼“å­˜æœªåˆ·æ–°    â”‚
    â”‚                â”‚    â”‚                â”‚    â”‚                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    ```

  - ä¸ä¸€è‡´çŠ¶æ€çš„å…·ä½“è¡¨çŽ°

  - ```
    # 1. packages.xmlä¸­æœ‰è®°å½•ï¼Œä½†å…ƒæ•°æ®æ–‡ä»¶æŸå/ç¼ºå¤±
    W/PackageSettings: Skipping PackageSetting{...} due to missing metadata
    
    # 2. åŒ…ç®¡ç†å™¨æ‰«ææ—¶æ‰¾ä¸åˆ°å®Œæ•´ä¿¡æ¯
    W/PackageManager: Odd, missing scanned package com.ovopark.cloudpos
    ```

  - è¿™è¯´æ˜Žï¼š

    - packages.xmlï¼šä»ç„¶è®°å½•ç€åŒ…çš„å­˜åœ¨ï¼ˆUID=10098ï¼‰

    - å…ƒæ•°æ®æ–‡ä»¶ï¼šç”±äºŽæ–­ç”µä¸¢å¤±æˆ–æŸå

    - APKæ–‡ä»¶ï¼šå¯èƒ½å®Œæ•´ï¼ˆæ‰€ä»¥åŽç»­èƒ½ä¿®å¤ï¼‰

ä¸ºä»€ä¹ˆæ–­ç”µä¼šå¯¼è‡´Androidæ–‡ä»¶ç³»ç»Ÿä¸ä¸€è‡´ï¼Ÿ

- ç¼“å­˜å†™å…¥å»¶è¿Ÿï¼ˆWrite-Backï¼‰

  - ```
    åº”ç”¨å†™å…¥æ•°æ®çš„å®žé™…æµç¨‹ï¼š
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Appå†™å…¥è¯·æ±‚     â”‚ â”€â”€â”€â†’ â”‚  å†…å­˜ç¼“å­˜åŒº      â”‚ â”€â”€â”€â†’ â”‚  ç‰©ç†å­˜å‚¨ä»‹è´¨    â”‚
    â”‚  write()        â”‚    â”‚  (Page Cache)   â”‚    â”‚  (å‡ ç§’åŽ)       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    ```

  - å…³é”®æ—¶é—´ç‚¹ï¼š

    - write() è°ƒç”¨ï¼šæ•°æ®åªåˆ°è¾¾å†…å­˜ç¼“å­˜

    - sync() è°ƒç”¨ï¼šå¼ºåˆ¶åˆ·æ–°åˆ°å­˜å‚¨

    - å®šæ—¶åˆ·æ–°ï¼šç³»ç»Ÿæ¯5-30ç§’è‡ªåŠ¨åˆ·æ–°

- EXT4æ–‡ä»¶ç³»ç»Ÿçš„æ—¥å¿—æœºåˆ¶

  - ```
    EXT4æ—¥å¿—æ¨¡å¼ï¼ˆJournalingï¼‰ï¼š
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  æ•°æ®å†™å…¥è¯·æ±‚     â”‚ â”€â”€â”€â†’ â”‚  å†™å…¥Journal     â”‚ â”€â”€â”€â†’ â”‚  æäº¤åˆ°å®žé™…ä½ç½®  â”‚
    â”‚                â”‚    â”‚  (äº‹åŠ¡æ—¥å¿—)      â”‚    â”‚  (ç¨åŽå¼‚æ­¥)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    ```

  - æ–­ç”µé£Žé™©çª—å£ï¼š

    - Journalå·²å†™å…¥ï¼Œä½†å®žé™…æ•°æ®åŒºæœªæ›´æ–°

    - å¤šä¸ªç›¸å…³æ–‡ä»¶çš„æ›´æ–°é¡ºåºä¸ç¡®å®š

- åŒ…ç®¡ç†æ“ä½œçš„å¤æ‚æ€§

  - ```
    åŒ…å®‰è£…æ¶‰åŠçš„æ–‡ä»¶æ“ä½œï¼š
    â”œâ”€â”€ /data/app/åˆ›å»ºç›®å½•
    â”œâ”€â”€ å¤åˆ¶APKæ–‡ä»¶ï¼ˆå¤§æ–‡ä»¶ï¼Œè€—æ—¶é•¿ï¼‰
    â”œâ”€â”€ è§£åŽ‹å¹¶éªŒè¯APK
    â”œâ”€â”€ æ›´æ–°/data/system/packages.xml
    â”œâ”€â”€ åˆ›å»ºåº”ç”¨æ•°æ®ç›®å½•
    â”œâ”€â”€ è®¾ç½®æƒé™å’ŒSELinuxæ ‡ç­¾
    â””â”€â”€ é€šçŸ¥PackageManageråˆ·æ–°ç¼“å­˜
    ```

  - æ¯ä¸ªæ­¥éª¤éƒ½æœ‰æ–­ç”µé£Žé™©ï¼Œå¯¼è‡´ä¸åŒç¨‹åº¦çš„ä¸ä¸€è‡´ã€‚

ä»Žæ—¥å¿—çœ‹åˆ°çš„å…·ä½“æ¢å¤è¿‡ç¨‹

- ```
  # 1. å‘çŽ°ä¸ä¸€è‡´
  W/PackageManager: Odd, missing scanned package com.ovopark.cloudpos
  
  # 2. å¼ºåˆ¶é‡å»º
  I/ActivityManager: Force stopping com.ovopark.cloudpos appid=10098 user=-1: installPackageLI
  
  # 3. è·¯å¾„é‡åˆ†é…
  I/PackageManager: Update package com.ovopark.cloudpos code path from 
  /data/app/~~HODkIO5boUGJS-rerYZ_vw==/com.ovopark.cloudpos-VQOa-fdTv6ZLexrJOVvSLQ== 
  to 
  /data/app/~~OPQuqViPoLxNkXX3H7Axpw==/com.ovopark.cloudpos-BWbHci_6oJZCXpGRG6tbaw==
  ```

- è¿™ä¸ªè¿‡ç¨‹è¡¨æ˜Žï¼š

  - åŽŸAPKå¯èƒ½ä»ç„¶å®Œæ•´ï¼ˆåœ¨æ—§è·¯å¾„ï¼‰
  - å…ƒæ•°æ®å·²æŸåéœ€è¦é‡å»º
  - ç³»ç»Ÿé€‰æ‹©é‡æ–°åˆ†é…è·¯å¾„é¿å…å†²çª



## 03.ä»£ç åˆ†æž

### 3.1 å…³è”ä»£ç è·¯å¾„

- 

### 3.2 å¯ç–‘ä¿®æ”¹ç‚¹

- 

## 04.å¤çŽ°æ­¥éª¤





## 05.è§£å†³æ–¹æ¡ˆå°è¯•

### 5.1 ç¬¬ä¸€æ¬¡è§£å†³æ–¹æ¡ˆ

- åˆ†æžï¼š
  - 
- è§£å†³æ–¹æ¡ˆï¼š
  - 
- ç»“æžœï¼š
  - 

### 5.2 ç¬¬äºŒæ¬¡è§£å†³æ–¹æ¡ˆ

- åˆ†æžï¼š
- è§£å†³æ–¹æ¡ˆï¼š
  - 
- ç»“æžœï¼š
  - 

### 5.3 ç¬¬ä¸‰æ¬¡è§£å†³æ–¹æ¡ˆ

- åˆ†æžï¼š
  - 
- è§£å†³æ–¹æ¡ˆï¼š
  - 
- ç»“æžœï¼š
  - 

### 5.4 ç¬¬å››æ¬¡è§£å†³æ–¹æ¡ˆ

- åˆ†æžï¼š
  - 

- è§£å†³æ–¹æ³•ï¼š
  - 
- ç»“æžœï¼š
  - 

### 5.4 ç¬¬äº”æ¬¡è§£å†³æ–¹æ¡ˆ

- åˆ†æžï¼š
  - 
- è§£å†³æ–¹æ¡ˆï¼š
  - 
- ç»“æžœï¼šæˆåŠŸè§£å†³é—®é¢˜



## 06.è¿›ä¸€æ­¥æ€è€ƒ

### 6.1 æœ‰æ²¡æœ‰å…¶ä»–æ›´ä¼˜é›…çš„æ–¹æ¡ˆ

- 

### 6.2 æŽ¨èæ–¹æ¡ˆ





## 07.æ ¹æœ¬åŽŸå› å’Œä¿®å¤

### 7.1 æœ€ç»ˆå®šä½

- 


### 7.2 ä¿®å¤æ–¹æ¡ˆ



## 08.ç»éªŒæ€»ç»“

### 8.1 æŠ€æœ¯åŽŸç†

### 8.2 é¢„é˜²æŽªæ–½

### 8.3 å¸è½½è§„èŒƒ

### 8.4 è°ƒè¯•æŠ€å·§



