[toc]

## é¡¹ç›®ç”±æ¥

æˆ‘ä»¬æœ‰ä¸ªå®‰å“ä¸Šçš„çˆ±æ™ºappï¼Œè¿™ä¸ªæ˜¯è¥¿å®‰æ–¹é¢çš„ã€‚ç„¶åé¢†å¯¼å¸Œæœ›èƒ½å¤Ÿåœ¨é‡Œé¢åŠ ä¸ŠçŸ­è§†é¢‘æ’­æ”¾çš„åŠŸèƒ½ï¼Œå°±åƒæŠ–éŸ³ä¸€æ ·ã€‚å› æ­¤æŠŠè¿™ä¸ªä»»åŠ¡åˆ†å‘åˆ°æˆ‘è¿™ã€‚

ç»è¿‡ä¸€ç³»åˆ—çš„åˆ†æï¼Œéœ€æ±‚åˆ†æï¼Œå¯è¡Œæ€§åˆ†æä¹‹åï¼Œæˆ‘éœ€è¦åšå‡ºä¸€ä¸ªéªŒè¯æ€§çš„æ–¹æ¡ˆæ¥ç»™é¢†å¯¼ä½“éªŒã€‚æˆ‘é‡‡ç”¨äº†MVCæ¶æ„ã€‚

## 00. é¡¹ç›®ä»‹ç»

- æˆ‘çš„é¡¹ç›®æ˜¯ä»¿æŠ–éŸ³TikToké¡¹ç›®
- é¡¹ç›®æ•´ä½“ç»“æ„ï¼š
  - é¡¹ç›®åˆ†ä¸ºå¯åŠ¨é¡µï¼Œé¦–é¡µå’Œä¸ªäººä¸»é¡µã€‚

  - å¯åŠ¨é¡µæ˜¾ç¤ºå¯åŠ¨å›¾æ ‡ï¼Œå¹¶è¿›è¡Œæ•°æ®çš„åˆå§‹åŒ–ã€‚

  - é¦–é¡µä¸­åŒ…å«æ¨èé¡µï¼Œå¯ä»¥åœ¨é‡Œé¢è§‚çœ‹è§†é¢‘ï¼Œæš‚åœè§†é¢‘ï¼ŒåŒå‡»å±å¹•æ˜¾ç¤ºçˆ±å¿ƒä¹Ÿå¯ä»¥å…³æ³¨ä½œè€…ï¼Œç‚¹èµæ˜¾ç¤ºåŠ¨ç”»ï¼ŒæŸ¥çœ‹è¯„è®ºï¼ŒæŸ¥çœ‹è½¬å‘ã€‚ä¹Ÿå¯ä»¥ç‚¹å‡»ä½œè€…çš„åœ†å½¢å¤´åƒè¿›å…¥å…¶ä¸ªäººä¸»é¡µã€‚

  - é¦–é¡µä¸­è¿˜åŒ…å«é™„è¿‘çš„äººï¼Œå¯ä»¥åœ¨é‡Œé¢æŸ¥çœ‹é™„è¿‘ç”¨æˆ·å‘å¸ƒè§†é¢‘çš„ç¼©ç•¥å›¾ï¼Œå¹¶ä¸”å¯ä»¥ç‚¹è¿›å»æ’­æ”¾ã€‚

  - ä¸ªäººä¸»é¡µå¯ä»¥æŸ¥çœ‹ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼šå¤´åƒï¼Œæ˜µç§°ï¼Œå¹´é¾„å•Šï¼Œä»¥åŠå®ƒçš„ä½œå“çš„ç¼©ç•¥å›¾ã€‚

  - ![image-20250222173849432](./../_pic_/image-20250222173849432.png)




## 02. é¡¹ç›®æŠ€æœ¯ç‚¹ï¼š

- é¦–å…ˆæ˜¯ç”¨æˆ·çš„åœ†å½¢å¤´åƒï¼Œé€šè¿‡è‡ªå®šä¹‰CircleImageViewï¼Œæ˜¾ç¤ºåœ†å½¢çš„ç”¨æˆ·å¤´åƒä»¥åŠå¤´åƒæŒ‰å‹æ•ˆæœã€‚

- ç„¶åæ˜¯LikeViewåœ¨æ¨èé¡µçš„åŒå‡»ä½ç½®ä¸Šæ–¹æ˜¾ç¤ºç‚¹èµåŠ¨ç”»ã€‚

- æ¥ç€æ˜¯ç”¨æˆ·çˆ±å¿ƒæŒ‰é’®çš„ç‚¹èµåŠ¨ç”»ï¼Œé‡‡ç”¨LottieAnimationViewå»åŠ è½½JSONåŠ¨ç”»ã€‚

- ExoPlayerè¿›è¡Œè§†é¢‘çš„æ’­æ”¾ã€‚

- æ¨èé¡µä¸­ä¸Šä¸‹æ»šåŠ¨çš„è§†å›¾é‡‡ç”¨RecyclerView + ViewHolder ç®¡ç†æ»šåŠ¨åˆ—è¡¨ä¸­åˆ—è¡¨é¡¹çš„æ˜¾ç¤ºå’Œæ•°æ®ç»‘å®šï¼Œå¹¶é€šè¿‡DifUtilè¿›è¡Œæ¡ç›®çº§åˆ«è§†å›¾çš„æ›´æ–°ã€‚

- å„ç»„ä»¶é—´é‡‡ç”¨RxBusè¿›è¡Œé€šä¿¡ã€‚

  > â€œRxBus æ˜¯è¿›ç¨‹å†…çš„çº¿ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼Œæ ¸å¿ƒæ˜¯é€šè¿‡ä¸€ä¸ªå…¨å±€çš„ `Subject`ï¼ˆå¦‚ `PublishSubject`ï¼‰ç®¡ç†è§‚å¯Ÿè€…åˆ—è¡¨ã€‚æˆ‘ä»¬æ³¨å†Œæ—¶ï¼Œä¼šå‘è¿™ä¸ª**è§‚å¯Ÿè€…ï¼ˆObserverï¼‰åˆ—è¡¨**ä¸­æ·»åŠ è‡ªèº«ã€‚å½“è°ƒç”¨ `post(event)` æ—¶ï¼Œä¼šéå†è§‚å¯Ÿè€…é“¾è¡¨ï¼Œè°ƒç”¨ä»–ä»¬çš„nextæ–¹æ³•ï¼Œå°†æ¶ˆæ¯åˆ†å‘ç»™ä»–ä»¬è¿›è¡Œå¤„ç†ã€‚å¼€å‘è€…å¯é€šè¿‡ `observeOn()` æŒ‡å®šæ¥æ”¶çº¿ç¨‹ï¼Œå®ç°è·¨çº¿ç¨‹é€šä¿¡ã€‚
  
  

## 03. é¡¹ç›®æ•´ä½“æµç¨‹ï¼š

### 3.1 å¯åŠ¨æµç¨‹

- å¯åŠ¨æµç¨‹ï¼šç”¨æˆ·ç‚¹å‡»æ¡Œé¢å›¾æ ‡ï¼Œå¯åŠ¨ç¨‹åºï¼Œå¯åŠ¨SplashActivity

### 3.2 SplashActivity

- è§†å›¾ï¼šSplashActivityå†…éƒ¨æ˜¯ä¸€ä¸ªé»‘è‰²èƒŒæ™¯çš„RelativeLayoutï¼Œå†…éƒ¨æœ‰ä¸€ä¸ªå›ºå®šå¤§å°çš„ImageViewï¼Œå…¶centerInParentï¼Œç”¨äºæ˜¾ç¤ºå¯åŠ¨ç•Œé¢ã€‚
- ä»£ç é€»è¾‘ï¼šè°ƒç”¨initæ–¹æ³•è¿›è¡Œæœ¬åœ°æ•°æ®çš„åˆå§‹åŒ–ï¼ˆå› ä¸ºæˆ‘æ²¡æœ‰ç½‘ç»œï¼Œè‡ªå·±æ„é€ çš„è§†é¢‘åˆ—è¡¨æ•°æ®å’Œç”¨æˆ·åˆ—è¡¨æ•°æ®ï¼‰ã€‚å¹¶é€šè¿‡è®¡æ—¶å™¨ç­‰å¾…å¯åŠ¨å›¾æ ‡æ˜¾ç¤º300msåå¯åŠ¨MainActivityä¸»Activityã€‚

### 3.3 MainActivity

- è§†å›¾ï¼šMainActivityæ˜¯ä¸€ä¸ªRelativeLayoutï¼Œå†…éƒ¨æ˜¯ä¸€ä¸ªViewPagerï¼Œå®¹çº³ä¸¤ä¸ªFragmentã€‚åˆ†åˆ«æ˜¯é¦–é¡µå’Œä¸ªäººä¸»é¡µã€‚
- ä»£ç é€»è¾‘ï¼š
  - æˆ‘ä»¬é€šè¿‡åˆ›å»ºpagerAdapterä¸ºViewPagerå¡«å……ä¸¤ä¸ªfragmentã€‚
  - å› ä¸ºæˆ‘ä»¬æ’­æ”¾è§†é¢‘çš„é€»è¾‘æ˜¯åœ¨é¦–é¡µçš„æ¨èé¡µä¸­çš„ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬ä»é¦–é¡µåˆ‡æ¢åˆ°ä¸ªäººä¸»é¡µï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œè§†é¢‘æ’­æ”¾çš„æš‚åœã€‚ä»ä¸ªäººä¸»é¡µåˆ‡å›æ¥ï¼Œæˆ‘ä»¬éœ€è¦ç»§ç»­è§†é¢‘çš„æ’­æ”¾ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åœ¨PageChangeListeneré¡µé¢åˆ‡æ¢ç›‘å¬å™¨çš„onPageSelectedé€»è¾‘ä¸­æ ¹æ®é¡µé¢ä½ç½®é€šè¿‡RxBuså‘é€ä¸€ä¸ªPauseVideoEventï¼ˆç”¨æˆ·åœ¨æ¨èé¦–é¡µä¸­ä¼šè®¢é˜…è¯¥äº‹ä»¶ï¼Œè°ƒç”¨VideoPlayerè¿›è¡Œæ’­æ”¾å’Œæš‚åœï¼‰
  - å¦ä¸€ä¸ªï¼Œç”¨æˆ·å¯èƒ½åœ¨åœ¨æ¨èé¡µä¸­ç‚¹å‡»å¤´åƒæ¥åˆ‡æ¢åˆ°ä¸ªäººä¸»é¡µï¼Œå› æ­¤æˆ‘ä»¬è¦åœ¨è¿™é‡Œé€šè¿‡RxBusè®¢é˜… MainPageChangeEvent ç±»å‹çš„äº‹ä»¶ï¼Œå½“äº‹ä»¶åˆ°æ¥æ—¶ï¼Œæˆ‘ä»¬åœ¨å†…éƒ¨è®¾ç½®ViewPagerçš„curItemæ¥è¿›è¡Œé¡µé¢çš„åˆ‡æ¢ï¼Œä»¥æ˜¾ç¤ºä¸ªäººä¸»é¡µã€‚
  - æœ€åæ˜¯åŒå‡»è¿”å›é”®çš„é€»è¾‘ã€‚
    - åœ¨onBackPressedæ–¹æ³•ä¸­æˆ‘ä»¬è®°å½•ä¸Šæ¬¡ç‚¹å‡»è¿”å›æŒ‰é”®çš„æ—¶é—´ï¼Œåˆ¤æ–­ä¸¤æ¬¡ç‚¹å‡»è¿”å›é”®æ˜¯å¦è¶…è¿‡æ—¶é—´é˜ˆå€¼ï¼Œæ²¡è¶…è¿‡é€€å‡ºåº”ç”¨ã€‚è¶…è¿‡åˆ™è¿”å›ç¬¬ä¸€ä¸ªé¡µé¢æˆ–å¼¹çª—å†æŒ‰ä¸€æ¬¡é€€å‡ºã€‚

### 3.4 MainFragment

- MainFragmentæ˜¯é¦–é¡µã€‚
- è§†å›¾ï¼šç”±RelativeLayoutåŒ…è£¹çš„ï¼Œåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œä¸Šæ–¹å¯¼èˆªï¼Œåº•éƒ¨å¯¼èˆªï¼Œmatch_parentçš„ViewPagerã€‚
  - ä¸Šæ–¹å¯¼èˆªæ˜¯RelativeLayoutæ°´å¹³å¸ƒå±€ï¼Œæœ€å·¦ä¾§çš„ç›´æ’­TextViewï¼Œæœ€å³ä¾§çš„æœç´¢ImageViewã€‚ä¸­é—´çš„æ˜¯ä¸€ä¸ªXTabLayoutã€‚å¹¶åœ¨XTabLayoutè®¾ç½®äº†é€‰ä¸­åé¦ˆï¼Œè¢«é€‰ä¸­çš„é€‰é¡¹å¡çš„æ–‡å­—é¢œè‰²ä¸ºç™½è‰²ã€‚æœªè¢«é€‰ä¸­çš„ä¸ºç°è‰²ã€‚
  - åº•éƒ¨å¯¼èˆªæ˜¯RealtiveLayoutæ°´å¹³å¸ƒå±€ï¼Œå†…éƒ¨åŒ…è£¹ä¸€ä¸ªXTabLayoutï¼Œä¸­é—´ä¸€ä¸ªå‘å¸ƒè§†é¢‘çš„ImageViewã€‚
  - è¿˜æœ‰ä¸€ä¸ªmatch_parentçš„ViewPagerå®¹çº³ä¸¤ä¸ªFragmentã€‚åˆ†åˆ«æ˜¯æ¨èé¡µå’Œé™„è¿‘çš„äººé¡µã€‚
- ä»£ç é€»è¾‘ï¼š
  - æˆ‘ä»¬é€šè¿‡åˆ›å»ºpagerAdapterä¸ºViewPagerå¡«å……ä¸¤ä¸ªfragmentã€‚
  - æ¥ç€ï¼Œå‡å¦‚æˆ‘ä»¬è¦åœ¨å†…éƒ¨è¿›è¡Œé¡µé¢åˆ‡æ¢ï¼Œä»æ¨èé¡µåˆ‡æ¢åˆ°é™„è¿‘çš„äººé¡µæ—¶ï¼Œä¹Ÿè¦è¿›è¡Œæ¨èé¡µä¸­è§†é¢‘çš„æ’­æ”¾å’Œæš‚åœæµç¨‹ï¼Œè¿™ä¸ªè·Ÿä¸Šé¢æ˜¯ä¸€æ ·ã€‚
  - ç„¶åä¸ºé¡¶éƒ¨çš„TabLayoutæ·»åŠ å¹¿å·å’Œæ¨èè¿™ä¸¤ä¸ªæ ‡é¢˜ã€‚ å¹¶é€šè¿‡TabLayoutçš„setupWithViewPagerå°†è¿™ä¸¤ä¸ªæ ‡é¢˜å’ŒViewPagerç®¡ç†èµ·æ¥ï¼Œä½¿å¾—é€‰é¡¹å¡å¯ä»¥éšç€ ViewPager çš„é¡µé¢å˜åŒ–è€Œæ›´æ–°ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡ç‚¹å‡» TabLayout çš„é€‰é¡¹å¡æ¥åˆ‡æ¢ ViewPager çš„é¡µé¢ã€‚
  - æœ€åæ˜¯ä¸ºä¸‹é¢çš„TabLayoutæ·»åŠ äº”ä¸ªæ ‡é¢˜ï¼Œä¸è¿‡æš‚æ—¶æ²¡æœ‰å¯¹åº”çš„é€»è¾‘å®ç°ï¼Œåªæ˜¯ä¸ºäº†æ¨¡ä»¿æŠ–éŸ³çš„è§†å›¾ã€‚

### 3.5 CurrentLocationFragment

- è§†å›¾ï¼šé™„è¿‘çš„äººé¡µæ˜¯ä¸€ä¸ªç”±SwipeRefreshLayoutï¼ˆä¸‹æ‹‰åˆ·æ–°è§†å›¾ï¼‰å¸ƒå±€ç±»åŒ…è£¹çš„RecyclerViewã€‚
- ä»£ç é€»è¾‘ï¼š
  - è®¾ç½®å¸ƒå±€ç®¡ç†å™¨ä¸ºä¸¤åˆ—å‚ç›´ã€‚
  - æˆ‘ä»¬é€šè¿‡åˆ›å»ºRecyclerView.adapteré€‚é…å™¨ä¸ºRecyclerViewå¡«å……å­æ¡ç›®ã€‚
  - å¤„ç†ä¸‹æ‹‰åˆ·æ–°æ“ä½œï¼Œæˆ‘ä»¬è¿™é‡Œæ˜¯ç®€å•æ¨¡æ‹Ÿåˆ·æ–°æ“ä½œï¼Œç»™ä¸‹æ‹‰åˆ·æ–°è§†å›¾æ³¨å†ŒsetOnRefreshListenerï¼Œå¹¶åœ¨å†…éƒ¨è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå®šæ—¶1000msï¼Œåœ¨å®šæ—¶å™¨ç»“æŸæ—¶å°†binding.refreshLayoutçš„isRefreshingå±æ€§è®¾ç½®ä¸ºfalseï¼Œåœæ­¢åˆ·æ–°ã€‚
- å­æ¡ç›®è§†å›¾é€»è¾‘ï¼šå…¶å†…éƒ¨æ˜¯å‚ç›´æ–¹å‘çš„LinearLayoutï¼Œè¢«LinearLayoutåŒ…è£¹çš„å¸ƒå±€å¦‚ä¸‹ï¼š
  - ä¸Šæ–¹ä¸€ä¸ªRelativeLayoutå’Œä¸‹æ–¹ä¸€ä¸ªTextViewã€‚
  - ä¸‹æ–¹çš„TextViewç”¨äºæ˜¾ç¤ºè§†é¢‘ç®€ä»‹ã€‚

  - ä¸Šæ–¹çš„RelativeLayoutå†…éƒ¨åˆ†ä¸ºå·¦ä¸‹çš„ LinearLayoutï¼Œ å³ä¸‹è‡ªå®šä¹‰çš„CircleImageViewå’Œä½œä¸ºèƒŒæ™¯çš„match_parentçš„ImageViewã€‚

    - å…¶ä¸­ImageViewç”¨äºæ˜¾ç¤ºè§†é¢‘å°é¢ï¼Œæ˜¯match_parent
    - è‡ªå®šä¹‰çš„CircleImageViewç”¨äºåœ¨å³ä¸‹è§’æ˜¾ç¤ºç”¨æˆ·å¤´åƒã€‚
    - LinearLayoutå†…éƒ¨åŒ…å«ä¸¤ä¸ªIconFontTextViewå›¾æ ‡å­—ä½“é€šè¿‡ç”¨æ¥æ˜¾ç¤ºè·ç¦»å›¾æ ‡å’Œè·ç¦»æ–‡å­—ã€‚æ˜¯wrap_contentã€‚
  - ![image-20250225121836744](./../_pic_/image-20250225121836744.png)

â€‹		![image-20250225121955975](./../_pic_/image-20250225121955975.png)

- å­æ¡ç›®é€»è¾‘ï¼š
  - onCreateViewHolderé˜¶æ®µåˆ›å»ºå­æ¡ç›®ç±»å‹ã€‚
  
  - åœ¨onBindViewHolderé˜¶æ®µï¼Œæˆ‘ä»¬ä¼šè¿›è¡ŒViewHolderçš„å¤ç”¨ã€‚
    - é¦–å…ˆé€šè¿‡Glideæå–è§†é¢‘é¦–å¸§ä½œä¸ºå°é¢å›¾ã€‚
    - ç„¶åè®¾ç½®è§†é¢‘æ–‡æ¡ˆï¼Œè·ç¦»ï¼Œç”¨æˆ·å¤´åƒã€‚
    
    > è¿™äº›æ•°æ®ä»å“ªæ¥çš„å‘¢ï¼Ÿ
    >
    > è¿™äº›æ•°æ®æ˜¯æˆ‘ä»¬ä¹‹å‰åœ¨SplashActivityé˜¶æ®µåˆå§‹åŒ–çš„æœ¬åœ°æ•°æ®ã€‚
    >
    > é€šè¿‡adapter?.appendList(DataCreate.datas)è®©adapteræŒæœ‰å®ƒçš„å¼•ç”¨ã€‚
    >
    > ç„¶åå°±å¯ä»¥é€šè¿‡è¿™äº›å¼•ç”¨è®¿é—®åˆ°æœ¬åœ°æ•°æ®ä¸ºå…¶èµ‹å€¼äº†ã€‚
    
    - æœ€åé€šè¿‡ `setOnClickListener` è®¾ç½®å­æ¡ç›®çš„ç‚¹å‡»äº‹ä»¶ï¼Œå…¶å¯åŠ¨ä¸€ä¸ªPlayListActivityè¿›è¡Œè§†é¢‘çš„æ’­æ”¾ï¼ŒåŒæ—¶ä¼ é€’ä¸€ä¸ª  position ä½œä¸ºè§†é¢‘æ’­æ”¾çš„ä½ç½®ã€‚
  
- PlayListActivityï¼š
  - ä»–æ˜¯ä¸€ä¸ªå•ç‹¬çš„Activityï¼Œå†…éƒ¨æœ‰ä¸€ä¸ªFrameLayoutã€‚å¯åŠ¨æ—¶ä¼šæ‰§è¡Œinitæ–¹æ³•ï¼Œè°ƒç”¨supportFragmentManagerçš„addæ–¹æ³•å°†ä¸€ä¸ªRecommendFragmentæ·»åŠ åˆ°è¿™ä¸ªFrameLayoutä¸­ï¼Œå…·ä½“çš„æ’­æ”¾é€»è¾‘ç”±RecommendFragmentæ‰§è¡Œã€‚

### 3.6 RecommendFragment

- è§†å›¾ï¼šæ¨èé¡µæ˜¯ä¸€ä¸ªç”±SwipeRefreshLayoutå¸ƒå±€ç±»åŒ…è£¹çš„ViewPager2
- ä»£ç é€»è¾‘ï¼šå…¶ä¼šåœ¨onViewCreatedé˜¶æ®µæ‰§è¡Œåˆå§‹åŒ–æ“ä½œï¼Œå…·ä½“æ˜¯ï¼š

  - æˆ‘ä»¬é€šè¿‡åˆ›å»ºRecyclerView.adapteré€‚é…å™¨ä¸ºViewPager2ä¸­çš„RecyclerViewå¡«å……å­æ¡ç›®ã€‚
  - ä¸ºViewPager2è®¾ç½®å¸ƒå±€ç®¡ç†å™¨ï¼Œå‚ç›´ï¼Œé¢„åŠ è½½1ä¸ªé¡µé¢ï¼Œæ»šåˆ°åˆ°æŒ‡å®šæ¡ç›®ä½ç½®ã€‚ï¼ˆè¿™é‡Œå¦‚æœç›´æ¥å¯åŠ¨ï¼Œé‚£ä¹ˆé»˜è®¤æ¡ç›®æ˜¯0ï¼Œå¦‚æœé€šè¿‡PlayListActivityå¯åŠ¨ï¼Œé‚£ä¹ˆå°±æ˜¯ç”¨æˆ·ç‚¹å‡»é™„è¿‘çš„äººé¡µä¸­çš„æ¡ç›®ï¼‰ã€‚
  - å¤„ç†ä¸‹æ‹‰åˆ·æ–°æ“ä½œï¼Œè·Ÿä¸Šé¢ä¸€æ ·ç®€å•çš„æ¨¡æ‹Ÿåˆ·æ–°æ“ä½œã€‚
  - å› ä¸ºéœ€è¦è§†é¢‘æ’­æ”¾å™¨æ’­æ”¾è§†é¢‘ï¼Œæ‰€ä»¥åˆå§‹åŒ–æ¨èé¡µå†…éƒ¨çš„è§†é¢‘æ’­æ”¾å™¨ã€‚
  - ä¹‹å‰æœ‰é¡µé¢åˆ‡æ¢å¯¼è‡´çš„æš‚åœäº‹ä»¶æ’­æ”¾é€»è¾‘ï¼Œæˆ‘ä»¬è®¢é˜…ä¹‹å‰é¡µé¢åˆ‡æ¢æ—¶äº§ç”Ÿçš„PauseVideoEventäº‹ä»¶ï¼Œè°ƒç”¨VideoPlayer.playæˆ–pauseï¼Œæ§åˆ¶è§†é¢‘çš„æš‚åœå’Œæ’­æ”¾ã€‚

  - æˆ‘ä»¬å¸Œæœ›ä¸‹æ»‘çš„è§†é¢‘å¯ä»¥è‡ªåŠ¨æ’­æ”¾ï¼Œå› æ­¤æ³¨å†ŒViewPager2çš„registerOnPageChangeCallbacké¡µé¢æ”¹å˜å›è°ƒï¼Œå½“ä¸Šä¸‹æ»‘åŠ¨å¯¼è‡´å­æ¡ç›®å˜æ›´æ—¶é€šè¿‡playCurVideoè‡ªåŠ¨æ’­æ”¾å½“å‰è§†é¢‘ã€‚
- å­æ¡ç›®è§†å›¾ï¼šå…¶å†…éƒ¨æ˜¯RelativeLayoutï¼Œè¢«RelativeLayoutåŒ…è£¹çš„å¸ƒå±€å¦‚ä¸‹ï¼š

  - ivCover_ImageViewæ˜¾ç¤ºè§†é¢‘å°é¢ï¼Œå…¶match_parent.
  - ç»§æ‰¿è‡ªRelativeLayoutçš„è‡ªå®šä¹‰è§†å›¾LikeViewï¼Œç”¨äºåœ¨åŒå‡»ä½ç½®ä¸Šæ–¹æ˜¾ç¤ºç‚¹èµåŠ¨ç”»ï¼Œå…¶match_parent.
  - ç»§æ‰¿è‡ªRelativeLayoutçš„è‡ªå®šä¹‰è§†å›¾ControllerViewï¼Œç”¨äºæ˜¾ç¤ºview_controllerè§†å›¾ï¼Œä¹Ÿå°±æ˜¯æŠ–éŸ³æ¨èé¡µå·¦ä¸‹è§’å’Œå³ä¸‹è§’çš„è§†å›¾ï¼Œå·¦ä¸‹è§’æ˜¯æ˜µç§°ï¼Œè§†é¢‘æ–‡æ¡ˆå’Œè·‘é©¬ç¯ï¼›å³ä¸‹è§’çš„æ˜¯å¤´åƒï¼Œçˆ±å¿ƒï¼Œè¯„è®ºï¼Œåˆ†äº«ã€‚å…¶match_parent.ï¼Œå…·ä½“åé¢ä»‹ç»ã€‚
  - ivPlay_ImageViewæ˜¾ç¤ºæ’­æ”¾æŒ‰é’®ï¼Œæ˜¾ç¤ºåœ¨è§†å›¾ä¸­å¤®ã€‚
- å­æ¡ç›®é€»è¾‘ï¼š

  - onCreateViewHolderé˜¶æ®µåˆ›å»ºå­æ¡ç›®ç±»å‹ã€‚
  - åœ¨onBindViewHolderé˜¶æ®µï¼Œæˆ‘ä»¬ä¼šè¿›è¡ŒViewHolderçš„å¤ç”¨ã€‚
    - é¦–å…ˆè®¾ç½®controllerViewè‡ªå®šä¹‰è§†å›¾çš„æ˜¾ç¤ºæ•°æ®
    - é€šè¿‡Glideæå–è§†é¢‘é¦–å¸§ä½œä¸ºå°é¢å›¾ã€‚
    - è®¾ç½®æ’­æ”¾æŒ‰é’®çš„é€æ˜åº¦ä¸ºåŠé€æ˜ `holder.binding.ivPlay.alpha = 0.4f`
    - è®¾ç½®ç‚¹èµç›‘å¬å™¨ï¼Œè¿™é‡Œæ˜¯ä¸ºLikeViewè®¾ç½®è‡ªå®šä¹‰çš„ç‚¹èµç›‘å¬æ–¹æ³• `this.onLikeListener = onLikeListener`ï¼Œå…¶æœ€ç»ˆä¼šåœ¨onDoubleTapçš„æ—¶å€™è°ƒç”¨addLikeä¸ºè§¦ç‚¹ä¸Šæ–¹æ·»åŠ çˆ±å¿ƒåŠ¨ç”» ä¹‹å è°ƒç”¨è¯¥æ–¹æ³• æ‰§è¡Œ `holder?.binding?.controller!!.like()`ï¼Œä¹Ÿå°±æ˜¯controllerViewçš„ivlikeçš„ç‚¹å‡»åŠ¨ç”»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åŒå‡»ç‚¹èµä¸ä»…ä¼šå‡ºç°ç‚¹èµåŠ¨ç”»ï¼Œè¿˜ä¼šè§¦å‘çˆ±å¿ƒæŒ‰é’®çš„ç‚¹å‡»åŠ¨ç”»ã€‚
    - è°ƒç”¨ buildMediaSource é¢„åŠ è½½å½“å‰å­æ¡ç›®çš„åª’ä½“èµ„æº `mList[position].mediaSource = buildMediaSource(mList[position].videoRes)`
  - ä½¿ç”¨DiffUtilè¿›è¡Œæ¡ç›®çº§åˆ«æ•°æ®çš„æ›´æ–°ã€‚
- æ¥ä¸‹æ¥æ¨èé¡µé¢ä¸­è§†é¢‘è‡ªåŠ¨æ’­æ”¾ï¼Œç”¨æˆ·å¯ä»¥å•å‡»è¿›è¡Œæš‚åœæˆ–æ’­æ”¾ã€‚ä¹Ÿå¯ä»¥åŒå‡»åœ¨è§¦ç‚¹ä¸Šæ–¹æ·»åŠ çˆ±å¿ƒåŠ¨ç”»ï¼Œå¹¶è§¦å‘ivLikeçš„åŠ¨ç”»ã€‚ä¹Ÿå¯ä»¥ç‚¹å‡»å¤´åƒè¿›å…¥ä¸ªäººä¸»é¡µï¼Œç‚¹å‡»ivlikeè§¦å‘çˆ±å¿ƒåŠ¨ç”»ï¼Œç‚¹å‡»è¯„è®ºæŸ¥çœ‹è¯„è®ºå¼¹çª—ï¼Œç‚¹å‡»åˆ†äº«è§¦å‘åˆ†äº«å¼¹çª—ã€‚

### 3.7 PersonalHomeFragment

- å°±æ˜¯ä¸€ä¸ªç®€å•çš„LinearLayoutï¼ŒåŒ…å«å¤´åƒï¼Œæ˜µç§°ï¼Œå¹´é¾„ç­‰è§†å›¾ç»„ä»¶ï¼Œä»æœ¬åœ°æ•°æ®ä¸­è·å–å¹¶è®¾ç½®ï¼Œæ²¡æœ‰ç‰¹åˆ«å¤šå¯ä»¥è®²çš„ã€‚

## å¾…è§£ç­”

- æœ¬åœ°æ•°æ®ä¸­å›¾ç‰‡èµ„æºåœ¨å“ªï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ

- onCreateViewHolderçš„è°ƒç”¨åŸç†ã€‚

- PlayListActivityæ€ä¹ˆå®šä½åˆ°æ’­æ”¾ç¬¬å‡ ä¸ªè§†é¢‘å‘¢ï¼Ÿ

  - RecommendFragmentåœ¨åˆå§‹åŒ–é˜¶æ®µä¼šè°ƒç”¨setViewPagerLayoutManagerè®¾ç½®å¸ƒå±€ç®¡ç†å™¨ï¼Œåœ¨å†…éƒ¨æˆ‘ä»¬é€šè¿‡scrollToPositionï¼šæ»šåŠ¨åˆ°åˆå§‹åŒ–çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„initPosã€‚

  - ```
    holder?.binding?.root?.setOnClickListener { v: View? ->              
        PlayListActivity.initPos = position              
        context.startActivity(Intent(context, PlayListActivity::class.java))
    }
    
    class PlayListActivity : BaseBindingActivity<ActivityPlayListBinding>({ActivityPlayListBinding.inflate(it)}) {
        /**
         * initPosï¼šä¸€ä¸ªé™æ€å˜é‡ï¼Œç”¨äºè®°å½•æ’­æ”¾åˆ—è¡¨çš„åˆå§‹ä½ç½®ã€‚å®ƒå¯ä»¥åœ¨å…¶ä»–ç±»ä¸­é€šè¿‡ PlayListActivity.initPos è®¿é—®å’Œä¿®æ”¹ã€‚
         */
        companion object {
            var initPos = 0
        }
    }
    
    
    private fun setViewPagerLayoutManager() {
        with(binding.recyclerView) {
            orientation = ViewPager2.ORIENTATION_VERTICAL
            offscreenPageLimit = 1
            registerOnPageChangeCallback(pageChangeCallback)
            (binding.recyclerView.getChildAt(0) as RecyclerView).scrollToPosition(PlayListActivity.initPos)
        }
    }
    ```

- RxBusä¸¤ä¸ªç»„ä»¶é—´é€šä¿¡åŸç†ã€‚

- ViewPager2å’ŒRecyclerViewé—´åŒºåˆ«ã€‚

















## 01. å¯åŠ¨æµç¨‹

- ç”¨æˆ·åœ¨æ‰‹æœºä¸Šçœ‹åˆ°çš„æ˜¯ä¸€ä¸ªå›¾è¡¨ï¼Œç”¨æˆ·ç‚¹å‡»å›¾è¡¨ï¼ŒLauncheré€šè¿‡Binder IPCå‘ActivityManagerServiceå‘é€`START_ACTIVITY`è¯·æ±‚ã€‚AMSé€šè¿‡socketè¯·æ±‚Zygote forkè‡ªèº«äº§ç”Ÿæ–°çš„åº”ç”¨ç¨‹åºã€‚Zygoteå­µåŒ–æ–°è¿›ç¨‹åï¼Œæ‰§è¡Œè¯¥ç¨‹åºçš„`ActivityThread.main()`å…¥å£
- æ­¤æ—¶è¿›å…¥åˆ°åº”ç”¨ç¨‹åºçš„ç»“æ„äº†ã€‚å…¶åœ¨èµ„æºåŠ è½½åä¼šåˆ›å»º**SplashActivity**ï¼Œå¯åŠ¨ç•Œé¢Activityã€‚è¿›å…¥å…¶ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œä¸ºä»€ä¹ˆä¼šæ‰§è¡ŒSplashActivityå‘¢ï¼Ÿå› ä¸ºæˆ‘é€šè¿‡åœ¨<intent-filter>ä¸­è®¾ç½®å…¶ä¸ºMAINï¼Œæ ‡è¯†å…¶ä¸ºå…¥å£Activityã€‚


## 02.SplashActivityæµç¨‹

- é‚£ä¹ˆä»€ä¹ˆæ˜¯SplashActivityå‘¢ï¼Ÿä¸ºä»€ä¹ˆæˆ‘æŠŠä»–å½“ä½œå…¥å£Activityå‘¢ï¼Ÿå› ä¸ºå®ƒæ˜¯å¯åŠ¨ç•Œé¢ï¼Œæˆ‘åœ¨é‡Œé¢è¿›è¡Œä¸€äº›æ•°æ®çš„åˆå§‹åŒ–å’Œå¯åŠ¨ç•Œé¢çš„æ˜¾ç¤ºæ“ä½œã€‚

- SplashActivityç»§æ‰¿è‡ªBaseBindingActivityï¼ŒBaseBindingActivityåˆ™ç»§æ‰¿è‡ªBaseActivityç±»ï¼ŒBaseBindingActivityæ˜¯æŠ½è±¡ç±»ï¼Œä¸»è¦æ˜¯ç”¨äºç»Ÿä¸€Activityä¸­è§†å›¾ç»‘å®šçš„è§„èŒƒã€‚BaseActivityç”¨äºç»Ÿä¸€Activityç±»çš„åˆ›å»ºï¼Œåˆå§‹åŒ–å’Œé€€å‡ºçš„è§„èŒƒã€‚
- BaseBindingActivityå¦‚ä½•å®ç°è§†å›¾ç»‘å®šï¼š
  - å…¶åœ¨å†…éƒ¨è®¾è®¡äº†åŒbindingå˜é‡ï¼Œä¸€ä¸ªæ˜¯privateçš„ç§æœ‰å˜é‡_bindingï¼Œä¸€ä¸ªæ˜¯protectedçš„å˜é‡`binding`ã€‚ç§æœ‰çš„bingdingåªèƒ½è‡ªå·±è®¿é—®ï¼Œprotectedçš„bingdingå®ƒçš„å­ç±»å¯ä»¥è®¿é—®ã€‚protectedçš„å˜é‡`binding`å®é™…ä¸Šæ˜¯é€šè¿‡getè·å–ç§æœ‰bindingå‰¯æœ¬ï¼Œæˆ‘ä»¬æ¯æ¬¡ä½¿ç”¨å®ƒéƒ½ä¼šé‡æ–°è·å–ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨å­ç±»ä¸­å¯¹è¿™ä¸ªbindingä¿®æ”¹ä¸ä¼šå½±å“åˆ°ä¸Šé¢ä¸€ä¸ªï¼Œè¿™å°±ä¿è¯äº†æ•°æ®çš„å®‰å…¨æ€§
  - å®ƒåœ¨æ„é€ å‡½æ•°ä¸­é€šè¿‡ä¸€ä¸ªå˜é‡blockï¼Œç”¨å…¶æ¥æ”¶å¸ƒå±€åˆå§‹åŒ–é€»è¾‘çš„lambdaè¡¨è¾¾å¼ï¼Œåœ¨onCreateé˜¶æ®µä½¿ç”¨è¯¥é€»è¾‘ä¸ºç§æœ‰bindingåˆå§‹åŒ–ï¼Œå¹¶é€šè¿‡setContentViewè®¾ç½®å¸ƒå±€ç•Œé¢ã€‚è¿™é‡Œçš„å¸ƒå±€é€»è¾‘å…¶å®ä¸¾ä¾‹ä¸ºï¼šActivitySplashBindingè°ƒç”¨çš„inflateã€‚ActivitySplashBindingæ˜¯ç”±ViewBindingè§£æSplashActivityçš„xmlå¸ƒå±€æ–‡ä»¶ç”Ÿæˆçš„è§†å›¾ç»‘å®šç±»ã€‚

- SplashActivityå†…éƒ¨å…¶å®å°±æ˜¯ä¸€ä¸ªImageViewï¼Œåœ¨ç»è¿‡è§†å›¾ç»‘å®šåï¼Œå…¶å°†å¯åŠ¨ç•Œé¢åŠ è½½å‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯æŠ–éŸ³çš„å¯åŠ¨ç•Œé¢ï¼ŒèƒŒæ™¯å…¨é»‘ï¼Œä¸­é—´ä¸€ä¸ªéƒ½æœ‰çš„å›¾æ ‡ã€‚
- ç„¶åå®ƒä¼šé€šè¿‡super.onCreateè°ƒç”¨ï¼ŒBaseActivityä¸­çš„OnCreateï¼Œå¹¶åœ¨é‡Œé¢è°ƒç”¨initæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è‡ªèº«é‡å†™çš„initæ–¹æ³•ã€‚å…¶åœ¨initæ–¹æ³•ä¸­è¿›è¡Œæ•°æ®çš„åˆå§‹åŒ–ï¼Œå¹¶é€šè¿‡è®¡æ—¶å™¨ç­‰å¾…æ˜¾ç¤ºç•Œé¢æ˜¾ç¤º300msåå¯åŠ¨MainActivityå¹¶å…³é—­SplashActivity
  - å› ä¸ºæˆ‘ä»¬æ²¡æœ‰ç½‘ç»œæ¥å£æä¾›è§†é¢‘å’Œç”¨æˆ·ä¿¡æ¯ï¼Œæ‰€ä»¥é‡‡ç”¨æœ¬åœ°æ•°æ®ã€‚ç”¨VideoBeanè¡¨ç¤ºè§†é¢‘å®ä½“ç±»ï¼ˆæ¯”å¦‚ï¼šç‚¹èµæ•°ï¼Œè½¬å‘æ•°ï¼Œè§†é¢‘æ’­æ”¾èµ„æºï¼‰ã€‚UserBeanè¡¨ç¤ºç”¨æˆ·å®ä½“ç±»ï¼ˆæ¯”å¦‚ï¼šæ˜µç§°ï¼Œå¤´åƒurlï¼Œè·èµæ•°ç­‰ï¼‰ã€‚UserBeanæ˜¯VideoBeançš„å†…éƒ¨ç±»ï¼Œè¡¨ç¤ºè§†é¢‘æ˜¯ç”±è¯¥ç”¨æˆ·å‘å¸ƒçš„ã€‚æˆ‘ä»¬åˆå§‹åŒ–äº†å‡ ä¸ªè§†é¢‘å’Œå®ƒçš„å‘å¸ƒè€…ï¼Œå°†å®ƒä»¬åˆ†åˆ«åŠ å…¥åˆ°ArrayListæ•°æ®é›†ä¸­ã€‚

- åœ¨å®Œæˆæ•°æ®çš„åˆå§‹åŒ–åï¼Œæˆ‘ä»¬é€šè¿‡è®¡æ—¶å™¨å¯åŠ¨äº†MainActivityå¹¶å…³é—­äº†SplashActivityã€‚

> æé—®ï¼šä¸ºä»€ä¹ˆä½¿ç”¨ViewBindingï¼Œä¼ ç»Ÿçš„è§†å›¾ç»‘å®šæ˜¯ä»€ä¹ˆæ ·çš„ï¼ŸViewBindingæœ‰ä»€ä¹ˆè¿›æ­¥çš„åœ°æ–¹ã€‚
>
> ä¼ ç»Ÿçš„é€»è¾‘ä¸­ï¼šè°ƒç”¨setContentViewè®¾ç½®å¸ƒå±€æ–‡ä»¶åï¼Œå†é€šè¿‡findViewById(R.id.view_id)æ¥è·å–æ¯ä¸ªè§†å›¾çš„å¼•ç”¨ã€‚è¿™ç§æ–¹æ³•çš„é—®é¢˜åœ¨äºéœ€è¦ä¸ºæ¯ä¸ªè§†å›¾ç¼–å†™å¤§é‡çš„ä»£ç 
>
> ViewBindingæ˜¯Androidå®˜æ–¹æ¨èçš„è§†å›¾ç»‘å®šè§£å†³æ–¹æ¡ˆã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯åœ¨ç¼–è¯‘æ—¶ä¸ºæ¯ä¸ªXMLå¸ƒå±€æ–‡ä»¶ç”Ÿæˆä¸€ä¸ªç»‘å®šç±»ï¼Œè¿™ä¸ªç±»åŒ…å«äº†æ‰€æœ‰åœ¨å¸ƒå±€ä¸­å£°æ˜äº†idçš„è§†å›¾çš„ç›´æ¥å¼•ç”¨ã€‚è¿™æ ·ï¼Œå°±æ— éœ€ä½¿ç”¨findViewByIdä¸€ä¸ªä¸ªè·å–äº†ï¼Œç®€åŒ–äº†ä»£ç ï¼Œæé«˜äº†å®‰å…¨æ€§ã€‚

## 03.MainActivityé€»è¾‘

- MainActivityå†…éƒ¨æ˜¯ä¸€ä¸ªViewPagerï¼Œå®¹çº³ä¸¤ä¸ªfragmentã€‚åˆ†åˆ«æ˜¯é¦–é¡µå’Œä¸ªäººä¸»é¡µã€‚
- é¦–å…ˆæ˜¯ViewPagerå†…å®¹çš„å¡«å……ï¼Œæˆ‘ä»¬é€šè¿‡pagerAdapterä¸ºViewPagerå¡«å……ä¸¤ä¸ªfragmentã€‚å…·ä½“æ˜¯ï¼š
  - å°†è¿™ä¸¤ä¸ªfragmentçš„å®ä¾‹åŠ å…¥åˆ°ArrayListæ•°æ®é›†ä¸­ã€‚
  - è°ƒç”¨PagerAdapterçš„æ„é€ å‡½æ•°ï¼Œä¼ é€’è¿™ä¸ªæ•°æ®é›†ä½œä¸ºå‚æ•°ã€‚
  - é€šè¿‡binding.viewPager!!.adapter = pagerAdapterä¸ºViewPagerè®¾ç½®é€‚é…å™¨ã€‚
  - ç„¶åé€‚é…å™¨è‡ªåŠ¨è¿›è¡Œå†…å®¹çš„å¡«å……ã€‚

> æ€ä¹ˆç†è§£è¿™ä¸ªé€‚é…å™¨å‘¢ï¼Ÿ
>
> - é€‚é…å™¨ï¼šç°åœ¨æœ‰è§†å›¾ï¼Œè§†å›¾ä¸­éœ€è¦æ˜¾ç¤ºå†…å®¹ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å¤šä¸ªå†…å®¹ï¼Œæ€ä¹ˆå§è¿™ä¸ªæ”¾åˆ°è¿™ä¸ªè§†å›¾é‡Œå‘¢ï¼Ÿè¦ä¸€ä¸ªä¸ªæ”¾å—ï¼Ÿå½“ç„¶ä¸ï¼Œæˆ‘ä»¬å¯ä»¥å€šèµ–é€‚é…å™¨ï¼Œå…·ä½“æ¥è¯´æˆ‘ä»¬ç»™é€‚é…å™¨ä¼ é€’å†…å®¹æ•°æ®ï¼Œå°†é€‚é…å™¨ç»‘å®šåˆ°è¿™ä¸ªè§†å›¾ä¸Šï¼Œè¿™æ ·é€‚é…å™¨ä¼šè‡ªåŠ¨è¿›è¡Œè§†å›¾å†…å®¹çš„ç®¡ç†å¡«å……ã€‚

- æ¥ç€ï¼Œä¸ºäº†å®ŒæˆViewPagerå†…éƒ¨çš„Fragmentçš„åˆ‡æ¢ï¼Œæˆ‘ä»¬è¿˜åœ¨initä¸­ä½¿ç”¨RxBusè®¢é˜… MainPageChangeEvent ç±»å‹çš„äº‹ä»¶ï¼Œå¹¶é€šè¿‡è®¾ç½®ViewPagerçš„å½“å‰é¡¹æ¥è¿›è¡Œé¡µé¢çš„åˆ‡æ¢ã€‚

> RxBusåŸç†

- ç„¶åæ˜¯é¡µé¢åˆ‡æ¢æ—¶æš‚åœå’Œæ¢å¤è§†é¢‘æ’­æ”¾ã€‚å½“ç”¨æˆ·åœ¨ViewPagerä¸­è¿›è¡Œæ»‘åŠ¨ï¼Œå¯¼è‡´Fragmentä»è§†é¢‘æ’­æ”¾é¡µåˆ‡æ¢åˆ°ç”¨æˆ·ä¸»é¡µï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦æš‚åœè§†é¢‘çš„æ’­æ”¾ã€‚å½“åˆ‡å…¥åˆ°è§†é¢‘æ’­æ”¾é¡µï¼Œæˆ‘ä»¬è¦ç»§ç»­è§†é¢‘çš„æ’­æ”¾ã€‚è¯·é—®æ­¤æ—¶æˆ‘ä»¬è¯¥æ€ä¹ˆå¤„ç†ï¼Ÿ

  - ç®€è¦æ¥è¯´æ˜¯åœ¨PageChangeListeneré¡µé¢åˆ‡æ¢ç›‘å¬å™¨çš„onPageSelectedé€»è¾‘ä¸­æ ¹æ®é¡µé¢ä½ç½®é€šè¿‡RxBuså‘é€ä¸€ä¸ªPauseVideoEventï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š

  - viewPageræ³¨å†ŒaddOnPageChangeListeneré¡µé¢åˆ‡æ¢ç›‘å¬å™¨
  - é¡µé¢åˆ‡æ¢ç›‘å¬å™¨çš„onPageSelectedé¡µé¢é€‰ä¸­æ–¹æ³•ä¸­ï¼Œåˆ¤æ–­é¡µé¢æ”¹å˜åæ˜¯å¦ä¸º0ï¼ˆè§†é¢‘æ’­æ”¾é¡µï¼‰ï¼Œå¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆé€šè¿‡RxBuså‘é€ä¸€ä¸ªPauseVideoEventäº‹ä»¶ï¼Œå‚æ•°ä¸ºfalseï¼Œè¡¨ç¤ºæš‚åœè§†é¢‘ã€‚å¦‚æœæ˜¯ï¼Œé‚£ä¹ˆå‘é€ä¸€ä¸ªå‚æ•°ä¸ºtrueçš„PauseVideoEventäº‹ä»¶è¡¨ç¤ºç»§ç»­è§†é¢‘çš„æ’­æ”¾ã€‚

- è¿˜æœ‰ç”¨æˆ·å¯èƒ½éœ€è¦é€šè¿‡ç‚¹å‡»è¿›è¡Œç•Œé¢è¿”å›æˆ–åº”ç”¨ç¨‹åºé€€å‡ºçš„é€»è¾‘

  - æˆ‘ä»¬é€šè¿‡è¦†å†™Activityç±»ä¸­onBackPressedæ–¹æ³•å®ç°ï¼Œå…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬è®°å½•ä¸Šæ¬¡ç‚¹å‡»è¿”å›é”®çš„æ—¶é—´ï¼Œå¹¶ç»™å‡ºä¸€ä¸ªè¿ç»­æŒ‰è¿”å›é”®é€€å‡ºçš„é˜ˆå€¼æ—¶é—´
  - æˆ‘ä»¬æ¯æ¬¡ç‚¹å‡»æ—¶æ£€æµ‹å½“å‰æ—¶é—´ä¸ä¸Šæ¬¡æŒ‰ä¸‹è¿”å›é”®çš„æ—¶é—´å·®æ˜¯å¦è¶…è¿‡äº†è®¾å®šçš„é˜ˆå€¼ EXIT_TIMEã€‚

  - å¦‚æœæ²¡è¶…è¿‡ï¼Œé‚£ä¹ˆç›´æ¥å…³é—­ç¨‹åºã€‚

  - å¦‚æœè¶…è¿‡ï¼Œå¹¶ä¸” ViewPager å½“å‰æ˜¾ç¤ºçš„æ˜¯ç¬¬äºŒä¸ªé¡µé¢ï¼ˆä¸ªäººä¸»é¡µï¼‰ï¼Œå°† ViewPager åˆ‡æ¢å›ç¬¬ä¸€ä¸ªé¡µé¢ï¼ˆé¦–é¡µï¼‰ã€‚

  - å¦‚æœè¶…è¿‡ï¼Œä½†æ˜¯å½“å‰é¡µé¢æ˜¯ç¬¬ä¸€ä¸ªç•Œé¢ï¼Œå¼¹å‡ºä¸€ä¸ª Toast æç¤ºç”¨æˆ·å†æ¬¡æŒ‰ä¸‹è¿”å›é”®ä»¥é€€å‡ºåº”ç”¨ï¼Œå¹¶æ›´æ–° lastTime ä¸ºå½“å‰æ—¶é—´ã€‚


## 04.MainFragment

> ä»€ä¹ˆæ˜¯Fragmentï¼Ÿ

- MainFragmentæ˜¯é¦–é¡µFragmentï¼Œå®ƒåŒæ ·ç»§æ‰¿è‡ªBaseBindingFragmentï¼Œè¿›è¡Œè§†å›¾ç»‘å®šçš„è§„èŒƒåŒ–æ“ä½œã€‚

- é¦–é¡µå†…éƒ¨æ˜¯æ¨èé¡µå’Œé™„è¿‘çš„äººé¡µï¼Œä»–ä»¬åŒæ ·é€šè¿‡ViewPagerå®¹çº³ã€‚

- é™¤äº†ViewPagerä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜æœ‰é¡¶éƒ¨å’Œåº•éƒ¨å¯¼èˆªã€‚

  - é¡¶éƒ¨å¯¼èˆªæ˜¯ä¸€ä¸ªRelativeLayoutï¼Œå†…éƒ¨æœ‰æœ€å·¦ä¾§çš„ç›´æ’­TextViewï¼Œæœ€å³ä¾§çš„æœç´¢ImageViewã€‚ä¸­é—´çš„æ˜¯ä¸€ä¸ªXTabLayoutåŒ…å«é™„è¿‘çš„äººå’Œæ¨èæ ç›®ã€‚é€šè¿‡å¦‚ä¸‹ä»£ç è®¾ç½®é€‰ä¸­åé¦ˆã€‚

  - ```
    - app:xTabSelectedTextColor="@color/white"ï¼šé€‰ä¸­æ ‡ç­¾çš„æ–‡å­—é¢œè‰²ä¸ºç™½è‰²ã€‚
    
    - app:xTabTextColor="#CCCCCC"ï¼šæœªé€‰ä¸­æ ‡ç­¾çš„æ–‡å­—é¢œè‰²ä¸ºæµ…ç°è‰²ã€‚
    ```

  - ![image-20250222230814656](./../_pic_/image-20250222230814656.png)

  - åº•éƒ¨å¯¼èˆªåŒæ ·ï¼Œä¸€ä¸ªXTabLayoutåŒ…å«é¦–é¡µï¼Œå¥½å‹ï¼Œæ¶ˆæ¯ï¼Œæˆ‘çš„æ ç›®ï¼Œä¸­é—´ä¸€ä¸ªå‘å¸ƒè§†é¢‘çš„ImageView

  - ![image-20250222230803994](./../_pic_/image-20250222230803994.png)

  > XTabLayoutæ˜¯ä»€ä¹ˆï¼Ÿ

- ä»£ç å†…éƒ¨é€»è¾‘ä¸ºï¼šonViewCreatedé˜¶æ®µè°ƒç”¨setFragmentså’ŒsetMainMenu
  
  - setFragmentsï¼š
    - å†…éƒ¨è®¾ç½®ViewPagerçš„pageadapterï¼Œå’Œä¸Šé¢ä¸€æ ·ã€‚
    - ç„¶åä¸ºé¡¶éƒ¨çš„TabLayoutæ·»åŠ å¹¿å·å’Œæ¨èä¸¤ä¸ªtabã€‚ 
    - ç„¶åé€šè¿‡TabLayoutçš„setupWithViewPagerå°†è¿™ä¸¤ä¸ªæ ‡é¢˜ç»„ä»¶å’ŒViewPagerç®¡ç†èµ·æ¥ï¼Œä½¿å¾—å…¶å¯ä»¥éšç€ ViewPager çš„é¡µé¢å˜åŒ–è€Œæ›´æ–°ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡ç‚¹å‡» TabLayout çš„é€‰é¡¹å¡æ¥åˆ‡æ¢ ViewPager çš„é¡µé¢ã€‚
    - è®¾ç½®é»˜è®¤é¡µä¸ºæ¨èé¡µã€‚
    - æœ€åè¿˜è®¾ç½®äº†é¡µé¢åˆ‡æ¢æ—¶è§†é¢‘çš„æ’­æ”¾å’Œæš‚åœæµç¨‹ï¼Œè·Ÿä¸Šé¢ä¸€æ ·ï¼Œä¸è¿‡ä¸Šé¢çš„æ˜¯é¦–é¡µå’Œä¸ªäººä¸»é¡µä¹‹é—´çš„ï¼Œè¿™é‡Œæ˜¯é¦–é¡µå†…éƒ¨çš„æ¨èé¡µå’Œé™„è¿‘çš„äººé¡µã€‚
  - setMainMenu
    - ä¸ºä¸‹é¢çš„TabLayoutæ·»åŠ äº”ä¸ªæ ‡é¢˜ï¼Œä¸è¿‡æ²¡æœ‰å¯¹åº”çš„é€»è¾‘å®ç°ï¼Œåªæ˜¯å•çº¯çš„æ˜¾ç¤ºã€‚

## 05.CurrentLocationFragment

- é™„è¿‘çš„äººé¡µæ˜¯ä¸€ä¸ªç”±SwipeRefreshLayoutå¸ƒå±€ç±»åŒ…è£¹çš„RecyclerViewã€‚
  - SwipeRefreshLayout ï¼ˆæ»‘åŠ¨åˆ·æ–°ï¼‰æ˜¯ä¸€ä¸ªå¸ƒå±€ç±»ï¼Œç”¨äºå®ç°ä¸‹æ‹‰åˆ·æ–°åŠŸèƒ½ã€‚å½“ç”¨æˆ·ä¸‹æ‹‰æ—¶ï¼Œä¼šæ˜¾ç¤ºä¸€ä¸ªåˆ·æ–°æŒ‡ç¤ºå™¨ï¼Œå¹¶è§¦å‘OnRefreshListener çš„ onRefresh() åˆ·æ–°å›è°ƒæ–¹æ³•ã€‚

> è¿™é‡Œä¸Šé¢å’Œä¸‹é¢æœ‰æ²¡æœ‰å¯ä»¥æ·±æŒ–çš„ï¼Ÿ

- å®ƒåœ¨onViewCreatedé˜¶æ®µæ‰§è¡Œinitæ“ä½œã€‚å…·ä½“æ˜¯ï¼š
  - è®¾ç½®å¸ƒå±€ç®¡ç†å™¨ä¸ºä¸¤åˆ—å‚ç›´ã€‚
  - è®¾ç½®RecyclerView.adapteré€‚é…å™¨
  - å¤„ç†ä¸‹æ‹‰åˆ·æ–°æ“ä½œï¼Œæˆ‘ä»¬è¿™é‡Œæ˜¯ç®€å•æ¨¡æ‹Ÿåˆ·æ–°æ“ä½œï¼Œåœ¨ binding.refreshLayout.setOnRefreshListenerå†…éƒ¨è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå®šæ—¶1000msï¼Œåœ¨å®šæ—¶å™¨ç»“æŸæ—¶å°†binding.refreshLayoutçš„isRefreshingå±æ€§è®¾ç½®ä¸ºfalseï¼Œåœæ­¢åˆ·æ–°ã€‚
  
    - ```
      binding.refreshLayout.setOnRefreshListener {
              object : CountDownTimer(1000, 1000) {
                  override fun onTick(millisUntilFinished: Long) {}
                  override fun onFinish() {
                      binding.refreshLayout!!.isRefreshing = false
                  }
              }.start()
          }
      ```
- è¿™é‡Œçš„å…³é”®ç‚¹æ˜¯RecyclerView.adapterï¼Œå®ƒä¸åƒä¹‹å‰çš„PagerAdapterä¸€æ ·ç®€å•ã€‚
  - é¦–å…ˆä»€ä¹ˆæ˜¯RecyclerView.adapterï¼Ÿè¦æƒ³ç†è§£RecyclerAdapterï¼Œä½ éœ€è¦å…ˆç†è§£RecyclerViewï¼Œå…¶æ˜¯ä¸€ä¸ªViewGroupï¼Œå†…éƒ¨æœ‰å¤šä¸ªç›¸åŒæ ·å¼çš„å­Viewï¼Œè¿˜æœ‰å¸ƒå±€æ–¹å¼ï¼ˆå­Viewåœ¨RecyclerViewä¸­çš„æ’åˆ—æ–¹å¼ï¼‰ï¼Œæ•°æ®é›†åˆï¼ˆå­Viewé€šè¿‡ç»‘å®šæ•°æ®é›†åˆä¸­çš„æ•°æ®æ¥æ˜¾ç¤ºå†…å®¹ã€‚ï¼‰
  - å› æ­¤å¯¹äºRecyclerAdapterï¼Œå…¶æœ‰ä»¥ä¸‹å…³é”®ç»„ä»¶ã€‚
    - RecyclerView.Adapter - è‡ªåŠ¨åŒ–å¤„ç†æ•°æ®é›†åˆå¹¶è´Ÿè´£ç»‘å®šè§†å›¾
    - ViewHolder - æŒæœ‰æ‰€æœ‰çš„ç”¨äºç»‘å®šæ•°æ®çš„View
    - LayoutManager - è´Ÿè´£æ‘†æ”¾è§†å›¾ç­‰ç›¸å…³æ“ä½œ 
    - å½“ç„¶è¿˜æœ‰**ItemDecoration** ç»˜åˆ¶åˆ†å‰²çº¿ç­‰ï¼Œåœ¨æ­¤ä¸åšè¿‡å¤šèµ˜è¿°ã€‚

  - > é‚£ä¹ˆï¼ŒViewHolderæ˜¯ä»€ä¹ˆï¼š
    >
    > - ViewHolderæ ¸å¿ƒä½œç”¨æ˜¯å®ç°è§†å›¾å¤ç”¨ã€‚å®ƒèº«æ˜¯æ¡ç›®è§†å›¾ï¼ˆå­Viewï¼‰çš„å®¹å™¨ã€‚å®¹çº³æ¡ç›®è§†å›¾ã€‚
    >
    >   - è€ƒè™‘ä¸€ä¸ªæ²¡æœ‰ViewHolderçš„æƒ…å†µï¼Œå¯¹äºRecyclerViewï¼Œå…¶æ˜¯ä¸€ä¸ªViewGroupï¼Œå†…éƒ¨åŒ…å«å¤šä¸ªå­Viewã€‚æˆ‘ä»¬è¿›è¡Œæ»‘åŠ¨æ“ä½œï¼Œå¦‚æœæ²¡æœ‰ViewHolderï¼Œé‚£ä¹ˆæ¯æ¬¡æ»‘åŠ¨åˆ°æ–°çš„ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨åœ¨adapteré€»è¾‘ä¸­åˆ›å»ºä¸€ä¸ªViewå®ä¾‹ï¼Œå¹¶å°†adapterä¸­çš„æ•°æ®æºè¾“å…¥åˆ°å¸ƒå±€ä¸­ã€‚åŒæ—¶æ—§çš„ä¼šè¢«é”€æ¯ã€‚è€Œæœ‰äº†ViewHolderï¼Œå…¶å¯ä»¥å®¹çº³å­Viewï¼Œåˆå› ä¸ºæ–°æ—§ä»–ä»¬çš„å¸ƒå±€é€»è¾‘éƒ½ä¸€æ ·ï¼Œæ‰€ä»¥åªéœ€è¦é€šè¿‡onBindViewHolderæ›´æ–°æ—§çš„ä¸­çš„æ•°æ®å³å¯ã€‚
    >
    > - è‹¥æ—  ViewHolder æœºåˆ¶ï¼Œæ¯æ¬¡åˆ—è¡¨æ»‘åŠ¨å¯¼è‡´æ–°æ¡ç›®è¿›å…¥å±å¹•æ—¶ï¼Œç³»ç»Ÿä¼šï¼š
    >
    >   - ğŸ“‰ **é¢‘ç¹è°ƒç”¨ `inflate()`**ï¼šXML è§£æå’Œ View å¯¹è±¡åˆ›å»ºï¼ˆè€—æ—¶æ“ä½œï¼‰
    >   - ğŸ“‰ **é‡å¤æ‰§è¡Œ `findViewById()`**ï¼šéå†è§†å›¾æ ‘æŸ¥æ‰¾å­ Viewï¼ˆCPU å¯†é›†å‹ï¼‰

  - okï¼Œæˆ‘ä»¬åœ¨onCreateViewHolderé˜¶æ®µåˆ›å»ºRecylerViewçš„å­æ¡ç›®ç±»å‹ã€‚è¿™é‡Œçš„å­æ¡ç›®ç±»å‹Viewçš„æ ·å¼ä¸ºï¼š

    - ä¸Šæ–¹ä¸€ä¸ªRelativeLayoutå’Œä¸‹æ–¹ä¸€ä¸ªTextViewã€‚

    - ä¸‹æ–¹çš„TextViewç”¨äºæ˜¾ç¤ºè§†é¢‘ç®€ä»‹ã€‚

    - ä¸Šæ–¹çš„RelativeLayoutå†…éƒ¨åˆ†ä¸ºImageViewï¼Œ LinearLayoutï¼Œ è‡ªå®šä¹‰çš„CircleImageViewã€‚

      - å…¶ä¸­ImageViewç”¨äºæ˜¾ç¤ºè§†é¢‘å°é¢
      - è‡ªå®šä¹‰çš„CircleImageViewç”¨äºåœ¨å³ä¸‹è§’æ˜¾ç¤ºç”¨æˆ·å¤´åƒã€‚
      - LinearLayoutå†…éƒ¨åŒ…å«ä¸¤ä¸ªIconFontTextViewç”¨æ¥æ˜¾ç¤ºè·ç¦»å›¾æ ‡å’Œè·ç¦»æ–‡å­—ã€‚

    - ![image-20250222233321906](./../_pic_/image-20250222233321906.png)

    - > IconFontTextViewæ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆæ˜¾ç¤ºè·ç¦»å›¾æ ‡ï¼Ÿ
      >
      > 
      >
      > å›¾æ ‡å­—ä½“æ˜¯ä¸€ç§ç‰¹æ®Šçš„å­—ä½“æ–‡ä»¶ï¼ˆå¦‚ .ttf, .otfï¼‰ï¼Œå®ƒå°†çŸ¢é‡å›¾å½¢æ˜ å°„åˆ° Unicode å­—ç¬¦ä¸Šã€‚
      >
      > IconFontTextViewæ˜¯ä¸€ä¸ª TextViewï¼Œä½†å®ƒé€šè¿‡å›¾æ ‡å­—ä½“ï¼ˆIconFont æŠ€æœ¯å°†ç‰¹å®šçš„ Unicode å­—ç¬¦æ¸²æŸ“ä¸ºå›¾å½¢ï¼Œä»è€Œå®ç°äº†ç±»ä¼¼å›¾ç‰‡çš„æ•ˆæœã€‚
      >
      > ä¾‹å¦‚ï¼šUnicode å­—ç¬¦ &#xe621; åœ¨æ™®é€šå­—ä½“ä¸­å¯èƒ½æ˜¾ç¤ºä¸ºä¹±ç ï¼Œä½†åœ¨å›¾æ ‡å­—ä½“ä¸­ä¼šè¢«æ¸²æŸ“ä¸ºæŸä¸ªå›¾å½¢ï¼ˆå¦‚è¯„è®ºå›¾æ ‡ï¼‰ã€‚
      >
      > è¿™é‡Œé€šè¿‡typeface = Typeface.createFromAsset(context.assets, "iconfont.ttf")åŠ è½½å›¾æ ‡å­—ä½“èµ„æºï¼Œç„¶åç›´æ¥ä½¿ç”¨Unicode ï¼Œæœ€åä¼šè¢«è‡ªåŠ¨æ¸²æŸ“ä¸ºå¯¹åº”å›¾å½¢ã€‚

    - æˆ‘ä»¬è‡ªå®šä¹‰çš„CircleImageViewæ˜¯ä»€ä¹ˆï¼Ÿå‚è€ƒç¬”è®°ã€‚
  
  
  - æ¥ç€ï¼Œåœ¨onBindViewHolderé˜¶æ®µï¼Œæˆ‘ä»¬ä¼šè¿›è¡ŒViewHolderçš„å¤ç”¨ã€‚
  
    - é¦–å…ˆæ˜¯Glideæå–è§†é¢‘é¦–å¸§ä½œä¸ºå°é¢å›¾ã€‚
  
    - > Glideå¦‚ä½•æå–è§†é¢‘é¦–å¸§ï¼Ÿä»£ç å¦‚ä¸‹ï¼š
      >
      > ```
      > Glide.with(context)
      >                 .asBitmap()
      >                 .load(it.videoRes)
      >                 .apply(RequestOptions.frameOf(0))  // ä»ç¬¬ä¸€å¸§å¼€å§‹
      >                 .into(holder.binding.ivCover)
      > ```
      >
      > é€»è¾‘å¦‚ä¸‹ï¼š
      >
      > - Glideç»„ä»¶ä¼šå¯åŠ¨åå°çº¿ç¨‹é€šè¿‡loadåŠ è½½è§†é¢‘èµ„æº
      > - ç„¶åé€šè¿‡apply(RequestOptions.frameOf(0))ï¼Œæˆ‘ä»¬å®šä½åˆ°è¿™ä¸ªè§†é¢‘çš„0msä½ç½®
      > - å¹¶é€šè¿‡asBitmapå°†å½“å‰è§†é¢‘çš„0msä½ç½®è¾“å‡ºä¸ºä½å›¾ï¼ˆå›¾ç‰‡çš„å½¢å¼ï¼‰
      > - æœ€åé€šè¿‡intoè®¾ç½®åˆ°ç›®æ ‡ImageViewã€‚
      > - ![image-20250223123753590](./../_pic_/image-20250223123753590.png)
  
    - ç„¶åè®¾ç½®è§†é¢‘æ–‡æ¡ˆï¼Œè·ç¦»ï¼Œç”¨æˆ·å¤´åƒ
  
    - æœ€åè®¾ç½®å­Viewçš„ç‚¹å‡»äº‹ä»¶ï¼Œå…¶å¯åŠ¨ä¸€ä¸ªPlayListActivityè¿›è¡Œè§†é¢‘çš„æ’­æ”¾ã€‚
  
    - > PlayListActivityæ˜¯ä»€ä¹ˆï¼Ÿ
      >
      > ä»–æ˜¯ä¸€ä¸ªå•ç‹¬çš„Activityï¼Œå†…éƒ¨æœ‰ä¸€ä¸ªFrameLayoutã€‚å¯åŠ¨æ—¶ä¼šæ‰§è¡Œå†…éƒ¨è¦†å†™çš„initæ–¹æ³•ï¼Œå°†ä¸€ä¸ªRecommendFragmentæ·»åŠ åˆ°IDä¸ºframelayoutçš„å®¹å™¨ä¸­ã€‚
      >
      > ```
      > override fun init() {
      >     supportFragmentManager.beginTransaction( ).add(R.id.framelayout, RecommendFragment()).commit()
      > }
      > ```
      >
      > æ‰€ä»¥ï¼Œæˆ‘ä»¬ç‚¹å‡»æœ¬åœ°é¡µé¢ç½‘æ ¼è§†å›¾çš„è§†é¢‘ç¼©ç•¥æ—¶ï¼Œå®é™…ä¸Šæ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„PlayListActivityï¼Œå…¶åœ¨å†…éƒ¨æ‰§è¡ŒRecommendFragmentï¼Œæ‰€ä»¥å¯ä»¥ç†è§£ä¸ºè·³è½¬åˆ°æ–°Activityä¸­çš„RecommendFragmentä¸‹æ’­æ”¾å¯¹åº”è§†é¢‘ã€‚

## 06.RecommendFragment

- æ¨èé¡µæ˜¯ä¸€ä¸ªç”±SwipeRefreshLayoutå¸ƒå±€ç±»åŒ…è£¹çš„ViewPager2ã€‚

- åœ¨ç»è¿‡è§†å›¾ç»‘å®šåï¼Œå…¶ä¼šåœ¨onViewCreatedé˜¶æ®µæ‰§è¡Œåˆå§‹åŒ–æ“ä½œï¼Œå…·ä½“æ˜¯ï¼š
  - ä¸ºViewPager2è®¾ç½®å¸ƒå±€ç®¡ç†å™¨
  - ä¸ºViewPager2å†…éƒ¨çš„recyclerViewè®¾ç½®RecyclerView.adapteré€‚é…å™¨ã€‚
  - å¤„ç†ä¸‹æ‹‰åˆ·æ–°æ“ä½œï¼Œè·Ÿä¸Šé¢ä¸€æ ·ç®€å•çš„æ¨¡æ‹Ÿåˆ·æ–°æ“ä½œã€‚
  - åˆå§‹åŒ–æ¨èé¡µå†…éƒ¨çš„è§†é¢‘æ’­æ”¾å™¨ã€‚
  - è®¢é˜…PauseVideoEventäº‹ä»¶ï¼Œæ§åˆ¶è§†é¢‘çš„æš‚åœå’Œæ’­æ”¾ã€‚

- é¦–å…ˆæ˜¯ä¸ºViewPager2è®¾ç½®å¸ƒå±€ç®¡ç†å™¨

  - è®¾ç½®å…¶ä¸ºå‚ç›´æ»‘åŠ¨

  - é¢„åŠ è½½å‰åå„ä¸€ä¸ªç•Œé¢

  - ç›‘å¬é¡µé¢åˆ‡æ¢ï¼Œå½“é¡µé¢åˆ‡æ¢æ—¶ï¼Œåœ¨`onPageSelected`ä¸­è§¦å‘æ’­æ”¾å½“å‰é¡µè§†é¢‘ã€‚å…·ä½“æ˜¯è°ƒç”¨playCurVideoï¼Œæˆ‘ä»¬åœ¨å¦å¤–ç¬”è®°ä¸­è¯´

  - è®¾ç½®é»˜è®¤æ’­æ”¾é¡µä¸º0ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªè§†é¢‘ã€‚

  - ```
    private fun setViewPagerLayoutManager() {
        with(binding.recyclerView) { 
            orientation = ViewPager2.ORIENTATION_VERTICAL // è®¾ç½®ä¸ºå‚ç›´æ»‘åŠ¨
            offscreenPageLimit = 1 // é¢„åŠ è½½å‰åå„1ä¸ªé¡µé¢
            registerOnPageChangeCallback(pageChangeCallback) // ç»‘å®šé¡µé¢ç›‘å¬
            // æ»šåŠ¨åˆ°åˆå§‹ä½ç½®ï¼ˆæ³¨æ„ï¼šç‰¹æ®Šæ“ä½œï¼‰
            (binding.recyclerView.getChildAt(0) as RecyclerView).scrollToPosition(PlayListActivity.initPos)
        }
    }
    private val pageChangeCallback = object: OnPageChangeCallback() {
        override fun onPageSelected(position: Int) {
            playCurVideo(position) // æ ¸å¿ƒæ’­æ”¾é€»è¾‘
        }
    }
    ```

  > æ€ä¹ˆç†è§£è¿™é‡Œçš„(binding.recyclerView.getChildAt(0) as RecyclerView).scrollToPosition(initPos)æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®ï¼Ÿ
  >
  > **ViewPager2 çš„å†…éƒ¨**ï¼šViewPager2 åº•å±‚å®é™…æ˜¯é€šè¿‡ **RecyclerView + LinearLayoutManager** å®ç°çš„ï¼ˆç³»ç»Ÿæºç å¯è§ï¼‰
  >
  > - `binding.recyclerView`ï¼šè™½ç„¶å˜é‡åæ˜¯recyclerViewï¼Œä½†å®é™…æŒ‡å‘çš„æ˜¯ViewPager2æ§ä»¶ï¼ˆå‘½åä¸è§„èŒƒï¼‰
  > - `getChildAt(0)`ï¼šè·å–ViewPager2å†…éƒ¨åŒ…è£¹çš„ **RecyclerViewå®ä¾‹**ï¼ˆViewPager2æºç ä¸­çš„ç§æœ‰æˆå‘˜`mRecyclerView`ï¼‰
  > - `as RecyclerView`ï¼šKotlinçš„ç±»å‹å¼ºåˆ¶è½¬æ¢ï¼ˆç­‰åŒäºJavaçš„`(RecyclerView)`ï¼‰
  > - `scrollToPosition(initPos)`ï¼šè®©å†…éƒ¨RecyclerViewç›´æ¥æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®

- ä¸ºViewPager2å†…éƒ¨çš„recyclerViewè®¾ç½®RecyclerView.adapteré€‚é…å™¨ã€‚å…¶å¸ƒå±€ç®¡ç†å™¨é€»è¾‘è¯¦è§ç¬”è®°ã€‚

- åˆå§‹åŒ–æ¨èé¡µå†…éƒ¨çš„è§†é¢‘æ’­æ”¾å™¨ã€‚è§†é¢‘æ’­æ”¾å™¨é€»è¾‘è¯¦è§ç¬”è®°ã€‚

- è®¢é˜…PauseVideoEventäº‹ä»¶ï¼Œæ§åˆ¶è§†é¢‘çš„æš‚åœå’Œæ’­æ”¾ã€‚

  - é€šè¿‡`toObservable()`åˆ›å»ºäº‹ä»¶è§‚å¯Ÿè€…ï¼Œè®¢é˜…`PauseVideoEvent`ç±»çš„äº‹ä»¶ã€‚

    > PauseVideoEventäº‹ä»¶è°ä¼šå‘å‡ºï¼Ÿ
    >
    > - è¿™é‡Œçš„ PauseVideoEvent äº‹ä»¶æ˜¯åœ¨MainActivityå’ŒMainFragmentçš„OnPageChangeListeneré˜¶æ®µå‘å‡ºçš„
    >
    > - é¡µé¢ä¸º0ï¼Œå‘é€æ’­æ”¾è§†é¢‘ï¼Œè¿›è¡Œè§†é¢‘çš„æ’­æ”¾ã€‚
    >
    > ```
    > //MainActivityä¸­é€»è¾‘
    > override fun onPageSelected(position: Int) {
    >         Log.d("pan","Parent onPageSelected, position: $position" );
    >         curMainPage = position
    >         if (position == 0) {
    >             RxBus.getDefault().post(PauseVideoEvent(true))
    >         } else if (position == 1) {
    >             RxBus.getDefault().post(PauseVideoEvent(false))
    >         }
    >     }
    >     
    > //MainFragmentä¸­é€»è¾‘ 
    > override fun onPageSelected(position: Int) {
    >             Log.d("pan", "child onPageSelected")
    >             curPage = position
    >             if (position == 1) {
    >                 //ç»§ç»­æ’­æ”¾
    >                 RxBus.getDefault().post(PauseVideoEvent(true))
    >             } else {
    >                 //åˆ‡æ¢åˆ°å…¶ä»–é¡µé¢ï¼Œéœ€è¦æš‚åœè§†é¢‘
    >                 RxBus.getDefault().post(PauseVideoEvent(false))
    >             }
    >         }
    > ```
    >
    > 
  
  - åˆ›å»ºäº†ä¸€ä¸ªAction1çš„å®ä¾‹æ¥å¤„ç†æ¥æ”¶åˆ°çš„äº‹ä»¶ã€‚
  
  - å½“æ¥æ”¶åˆ°`PauseVideoEvent`äº‹ä»¶æ—¶ï¼Œæ ¹æ®`event.isPlayOrPause`çš„å€¼æ¥å†³å®šæ˜¯è°ƒç”¨`videoView!!.play()`è¿˜æ˜¯`videoView!!.pause()`ã€‚
  
  - ```
    private fun observeEvent() {
        subscribe = RxBus.getDefault().toObservable(PauseVideoEvent::class.java)
            .subscribe(Action1 { event: PauseVideoEvent ->
                if (event.isPlayOrPause) {
                    videoView!!.play() // éç©ºæ–­è¨€æ’­æ”¾
                } else {
                    videoView!!.pause() // éç©ºæ–­è¨€æš‚åœ
                }
            } as Action1<PauseVideoEvent>)
    }
    
    ```
  
  - > RxBusåŸç†ï¼Ÿ

- è‡³æ­¤ï¼Œæ•´ä¸ªçš„æ’­æ”¾é€»è¾‘ä¸»é¡µé€»è¾‘å·²ç»å®Œæˆï¼Œæˆ‘ä»¬ç¼ºå°‘çš„æ˜¯
